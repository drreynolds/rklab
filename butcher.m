function B = butcher(method_name,symbolic)
% Usage: B = butcher(method_name,symbolic)
%
% Returns the butcher table associated with the method given by the input
% argument 'method_name'.  We compute the internal stage times (root nodes)
% c, the Butcher matrix A, the method coefficients b, and the order
% of accuracy for the method q.   The output table has the block structure
%     B = [c, A; q, b]
% for a standard Runge-Kutta method.
%
% If the method has an embedded error indicator, we also compute the embedded
% method's coefficients b2 and order of accuracy p, and provide the output
%     B = [c, A; q, b; p, b2]
%
% If the 'symbolic' input flag is both present and is 'true', then
% the resulting Butcher table is returned in symbolic format (to
% full precision).
%
% Method types are specified by the abbreviations:
%       ERK - explicit Runge Kutta (strictly lower-triangular A)
%       IRK - implicit Runge Kutta (dense A)
%      DIRK - diagonally-implicit Runge Kutta (lower-triangular A)
%     SDIRK - singly-diagonally implicit Runge Kutta (DIRK with fixed diagonal)
%    ESDIRK - SDIRK method with an initial explicit stage
%
% Allowed methods are listed below.  They are grouped by category
% (ERK, DIRK, IRK) and subcategory (non-embedded vs embedded).
% Each method lists:
% - the number of stages (s)
% - the order of accuracy of the stages (qs)  (implicit methods
%   only, since explicit method stage accuracy is limited to 1)
% - the order of accuracy of the method (q)
% - the linear order of the method (lq) -- i.e. the order of
%   accuracy when the IVP RHS f(t,y) depends linearly on y
% - A,B,L-stability of the method (implicit methods only)
%
% Additionally, if the method contains an embedding, the table
% below also lists:
% - the embedding order of accuracy (p)
% - the embedding linear order of accuracy (lp)
% - A,B,L-stability of the embedding (implicit methods only)
%
% For each method, the reported values of {q,p,qs,lq,lp} correspond
% to satisfaction of the order conditions for a loose tolerance of
% 1e-8.  For each method, we additionally report the tightest
% tolerance where these order conditions are still satisfied (to a
% minimum of 1e-40).
%
% Note: all method properties listed are automatically computed
% using the accompanying check_rk() function using symbolic
% variables to eliminate floating-point calculation error.  This
% routine tests the full analytical order conditions up to 6;
% thereafter it merely checks Butcher's simplifying assumptions to
% assess higher orders of accuracy.
%
% Since Butcher's simplifying assumptions correspond to sufficient
% (but not necessary) conditions for order of accuracy, we may
% report an accuracy of 6 when in fact the method has higher
% order. Methods where we report 6 but have higher published order
% are marked with "+".
%
% However, since we analytically assess the *necessary* order
% conditions up to 6, any method with published accuracy <= 6 that
% does NOT attain this published order is marked with "-".
%
% Explicit, non-embedded methods:
%
%             Name             |  s |  q  lq  |  tol
%   --------------------------------------------------
%                     ERK-1-1  |  1 |  1   1  | 1e-40
%                     ERK-2-2  |  2 |  2   2  | 1e-40
%             SSP2(2,2,2)-ERK  |  2 |  2   2  | 1e-40
%           Ascher(2,3,2)-ERK  |  3 |  2   3  | 1e-40
%              ARK(2,3,2)-ERK  |  3 |  2   3  | 1e-40
%           Ascher(2,2,2)-ERK  |  3 |  2   2  | 1e-40
%        SSP2(3,3,2)-lpm1-ERK  |  3 |  2   2  | 1e-40
%        SSP2(3,3,2)-lpm2-ERK  |  3 |  2   2  | 1e-40
%        SSP2(3,3,2)-lpum-ERK  |  3 |  2   2  | 1e-40
%       SSP2(3,3,2)-lspum-ERK  |  3 |  2   2  | 1e-40
%           SSP2(3,3,2)-a-ERK  |  3 |  2   2  | 1e-40
%           SSP2(3,3,2)-b-ERK  |  3 |  2   2  | 1e-40
%           Ascher(2,3,3)-ERK  |  3 |  3   3  | 1e-40
%             Knoth-Wolke-ERK  |  3 |  3   3  | 1e-40
%             SSP3(3,3,2)-ERK  |  3 |  3   3  | 1e-40
%             SSP3(3,3,3)-ERK  |  3 |  3   3  | 1e-40
%    SSPRK(3,3)-Shu-Osher-ERK  |  3 |  3   3  | 1e-40
%           Ascher(3,4,3)-ERK  |  4 |  3   4  | 1e-17
%                 Cooper4-ERK  |  4 |  3   3  | 1e-40
%             SSP3(4,3,3)-ERK  |  4 |  3   3  | 1e-40
%           Ascher(4,4,3)-ERK  |  5 |  3   3  | 1e-40
%                 DBM-5-3-ERK  |  5 |  3   3  | 1e-15
%                3/8-Rule-ERK  |  4 |  4   4  | 1e-40
%                     ERK-4-4  |  4 |  4   4  | 1e-40
%                 Cooper6-ERK  |  6 |  4-  4  | 1e-40
%             Butcher-7-6-ERK  |  7 |  6   6  | 1e-40
%            Butcher-7-6b-ERK  |  7 |  6   6  | 1e-40
%             Butcher-9-7-ERK  |  9 |  6+  7  | 1e-40
%       CooperVerner-11-8-ERK  | 11 |  6+  8  | 1e-14
%
%
% Explicit, embedded methods:
%
%                              |    |  Method |  Embedding  |
%             Name             |  s |  q  lq  |  p  lp      | tol
%   -----------------------------------------------------------------
%              Heun-Euler-ERK  |  2 |  2   2  |  1   1       | 1e-40
%                     ERK-3-3  |  3 |  3   3  |  2   2       | 1e-40
%          ARK3(2)4L[2]SA-ERK  |  4 |  3   3  |  2   2       | 1e-25
%        Bogacki-Shampine-ERK  |  4 |  3   3  |  2   2       | 1e-40
%              Merson-4-3-ERK  |  5 |  4   4  |  3   5       | 1e-40
%           Zonneveld-4-3-ERK  |  5 |  4   4  |  3   3       | 1e-40
%          ARK4(3)6L[2]SA-ERK  |  6 |  4   4  |  3   3       | 1e-25
%        Sayfy-Aburub-4-3-ERK  |  6 |  4   4  |  3   3       | 1e-40
%          ARK4(3)7L[2]SA-ERK  |  7 |  4   4  |  3   3       | 1e-25
%                Fehlberg-ERK  |  6 |  5   5  |  4   4       | 1e-40
%               Cash-Karp-ERK  |  6 |  5   5  |  4   4       | 1e-40
%          Dormand-Prince-ERK  |  7 |  5   5  |  4   4       | 1e-40
%          ARK5(4)8L[2]SA-ERK  |  8 |  5   5  |  4   4       | 1e-25
%         ARK5(4)8L[2]SAb-ERK  |  8 |  5   5  |  4   4       | 1e-25
%              Verner-6-5-ERK  |  8 |  6   6  |  5   5       | 1e-40
%            Fehlberg-8-7-ERK  | 13 |  6+  8  |  6+  7       | 1e-40
%
%
% Diagonally-implicit, non-embedded methods:
%
%             Name             |  s |  q  lq   A   B   L  |  qs  tol
%   ------------------------------------------------------------------
%           SSP2(2,2,2)-SDIRK  |  2 |  2   2   Y   Y   Y  |  1  1e-40
%         Ascher(2,3,2)-SDIRK  |  3 |  2   2   Y       Y  |  1  1e-40
%         Ascher(2,2,2)-SDIRK  |  3 |  2   2   Y       Y  |  1  1e-40
%            ARK(2,3,2)-SDIRK  |  3 |  2   2   Y       Y  |  2  1e-40
%      SSP2(3,3,2)-lpm1-SDIRK  |  3 |  2   2   Y       Y  |  1  1e-40
%      SSP2(3,3,2)-lpm2-SDIRK  |  3 |  2   2   Y       Y  |  1  1e-40
%      SSP2(3,3,2)-lpum-SDIRK  |  3 |  2   2   Y       Y  |  1  1e-40
%     SSP2(3,3,2)-lspum-SDIRK  |  3 |  2   2   Y       Y  |  1  1e-40
%          SSP2(3,3,2)-a-DIRK  |  3 |  2   2   Y       Y  |  1  1e-40
%          SSP2(3,3,2)-b-DIRK  |  3 |  2   2   Y       Y  |  1  1e-40
%           SSP3(3,3,2)-SDIRK  |  3 |  2   2   Y       Y  |  1  1e-40
%         Ascher(2,3,3)-SDIRK  |  3 |  3   3   Y   Y      |  1  1e-40
%          SSP3(3,3,3)-ESDIRK  |  3 |  3   3              |  1  1e-40
%                   EDIRK-3-3  |  3 |  3   3   Y          |  1  1e-40
%                  ESDIRK-3-3  |  3 |  3   3   Y          |  1  1e-40
%           SSP3(4,3,3)-SDIRK  |  4 |  3   3   Y          |  1  1e-14
%         Ascher(3,4,3)-SDIRK  |  4 |  3   3   Y       Y  |  1  1e-17
%         Ascher(4,4,3)-SDIRK  |  4 |  3   3   Y       Y  |  1  1e-40
%              Cooper4-ESDIRK  |  4 |  3   3   Y          |  1  1e-40
%              DBM-5-3-ESDIRK  |  5 |  3   3   Y       Y  |  1  1e-16
%             SDIRK4()5L[1]SA  |  5 |  4   4   Y       Y  |  1  1e-40
%               SDIRK5()5L[1]  |  5 |  5   5   Y       Y  |  1  1e-25
%              Cooper6-ESDIRK  |  6 |  4-  4   Y          |  1  1e-40
%
%
% Diagonally-implicit, embedded methods:
%
%                              |    |       Method        |      Embedding      |
%             Name             |  s |  q  lq   A   B   L  |  p  lp   A   B   L  |  qs  tol
%   ----------------------------------------------------------------------------------------
%                   SDIRK-2-1  |  2 |  2   2   Y   Y      |  1   1   Y   Y   Y  |  1  1e-40
%                   SDIRK-2-2  |  2 |  2   2   Y       Y  |  1   1              |  1  1e-40
%               TRBDF2-ESDIRK  |  3 |  2   2   Y       Y  |  3   3              |  2  1e-40
%                 TRX2-ESDIRK  |  3 |  2   2   Y          |  3   3              |  2  1e-40
%            Billington-SDIRK  |  3 |  2   2   Y          |  3   3              |  1  1e-11
%       ARK3(2)4L[2]SA-ESDIRK  |  4 |  3   3   Y       Y  |  2   2   Y          |  2  1e-25
%       Kvaerno(4,2,3)-ESDIRK  |  4 |  3   3   Y          |  2   2   Y          |  2  1e-14
%           ESDIRK3(2)4L[2]SA  |  4 |  3   3   Y       Y  |  2   2   Y          |  2  1e-40
%           ESDIRK3(2)5L[2]SA  |  5 |  3   3   Y       Y  |  2   2   Y       Y  |  2  1e-25
%          ESDIRK3(2I)5L[2]SA  |  5 |  3   3   Y       Y  |  2   2   Y       Y  |  2  1e-40
%                   SDIRK-5-4  |  5 |  4   4   Y       Y  |  3   3           Y  |  1  1e-40
%           Cash(5,3,4)-SDIRK  |  5 |  4   4   Y       Y  |  3   3   Y          |  1  1e-10
%       Kvaerno(5,3,4)-ESDIRK  |  5 |  4   4   Y          |  3   3   Y          |  2  1e-14
%           Cash(5,2,4)-SDIRK  |  5 |  4   4   Y       Y  |  2   2   Y          |  1  1e-10
%           ESDIRK4(3)6L[2]SA  |  6 |  4   4   Y       Y  |  3   3   Y       Y  |  2  1e-26
%           ESDIRK4(3)7L[2]SA  |  7 |  4   4   Y       Y  |  3   3   Y       Y  |  2  1e-25
%          ESDIRK4(3I)6L[2]SA  |  6 |  4   4   Y       Y  |  3   3   Y       Y  |  2  1e-25
%          QESDIRK4(3)6L[2]SA  |  6 |  4   4   Y       Y  |  3   3   Y       Y  |  2  1e-25
%       ARK4(3)6L[2]SA-ESDIRK  |  6 |  4   4   Y       Y  |  3   3   Y          |  2  1e-40
%       ARK4(3)7L[2]SA-ESDIRK  |  7 |  4   4   Y       Y  |  3   3   Y       Y  |  2  1e-25
%           ESDIRK5(3)6L[2]SA  |  6 |  5   5   Y       Y  |  3   3   Y       Y  |  2  1e-25
%           ESDIRK5(4)7L[2]SA  |  7 |  5   5   Y       Y  |  4   4   Y       Y  |  2  1e-26
%          ESDIRK5(4)7L[2]SA2  |  7 |  5   5   Y       Y  |  4   4   Y          |  2  1e-26
%           ESDIRK5(4)8L[2]SA  |  8 |  5   5   Y       Y  |  1   1              |  2  1e-25
%       ARK5(4)8L[2]SA-ESDIRK  |  8 |  5   5   Y       Y  |  4   4   Y          |  2  1e-25
%      ARK5(4)8L[2]SAb-ESDIRK  |  8 |  5   5   Y       Y  |  4   4   Y          |  2  1e-25
%       Kvaerno(7,4,5)-ESDIRK  |  7 |  5   5   Y       Y  |  4   4   Y          |  2  1e-15
%           ESDIRK6(5)9L[2]SA  |  9 |  6   6   Y       Y  |  0   0              |  2  1e-29
%          ESDIRK5(4I)8L[2]SA  |  8 |  0   0              |  0   0              |  0  -----
%             ESDIRK6(4)7A[2]  |  7 |  0   0              |  0   0              |  0  -----
%
%   Note: both ESDIRK5(4I)8L[2]SA and ESDIRK6(4)7A[2] seem to have typos in the 7th row
%   in the paper where they are presented, as both fail the row-sum condition.  Similarly,
%   both ESDIRK5(4)8L[2]SA and ESDIRK6(5)9L[2]SA seem to have typos in their embedding
%   coefficients, since their base methods show the appropriate order of accuracy, but the
%   embeddings are 1st and 0th order accurate, respectively.
%
% Fully-implicit, non-embedded methods:
%
%             Name             |  s |  q  lq   A   B   L  |  qs  tol
%   --------------------------------------------------------------------
%                     IRK-1-1  |  1 |  1   1   Y   Y   Y  |  1  1e-40
%         LobattoIIIC-2-2-IRK  |  2 |  2   2   Y   Y   Y  |  1  1e-40
%      Crank-Nicolson-2-2-IRK  |  2 |  2   2   Y          |  2  1e-40
%                    SIRK-2-2  |  2 |  2   2   Y       Y  |  2  1e-40
%         LobattoIIIA-2-2-IRK  |  2 |  2   2   Y          |  2  1e-40
%          LobattoIII-2-2-IRK  |  2 |  2   2              |  1  1e-40
%            RadauIIA-2-3-IRK  |  2 |  3   3   Y   Y   Y  |  2  1e-40
%               Gauss-2-4-IRK  |  2 |  4   4   Y   Y      |  2  1e-40
%         LobattoIIIC-3-4-IRK  |  3 |  4   4   Y   Y   Y  |  2  1e-40
%         LobattoIIIA-3-4-IRK  |  3 |  4   4   Y          |  3  1e-40
%         LobattoIIIB-3-4-IRK  |  3 |  4   4   Y          |  1  1e-40
%          LobattoIII-3-4-IRK  |  3 |  4   4              |  2  1e-40
%             RadauIA-3-5-IRK  |  3 |  5   5   Y   Y   Y  |  2  1e-40
%            RadauIIA-3-5-IRK  |  3 |  5   5   Y   Y   Y  |  3  1e-40
%              RadauI-3-5-IRK  |  3 |  5   5              |  3  1e-40
%             RadauII-3-5-IRK  |  3 |  5   5              |  2  1e-40
%               Gauss-3-6-IRK  |  3 |  6   6   Y   Y      |  3  1e-40
%         LobattoIIIC-4-6-IRK  |  4 |  6   6   Y   Y   Y  |  3  1e-40
%         LobattoIIIA-4-6-IRK  |  4 |  6   6   Y          |  4  1e-40
%         LobattoIIIB-4-6-IRK  |  4 |  6   6   Y          |  2  1e-40
%          LobattoIII-4-6-IRK  |  4 |  6   6              |  3  1e-40
%            RadauIIA-4-7-IRK  |  4 |  7   7   Y   Y   Y  |  4  1e-40
%         LobattoIIIC-5-8-IRK  |  5 |  8   8   Y   Y   Y  |  4  1e-40
%         LobattoIIIA-5-8-IRK  |  5 |  8   8   Y          |  5  1e-40
%         LobattoIIIB-5-8-IRK  |  5 |  8   8   Y          |  3  1e-40
%          LobattoIII-5-8-IRK  |  5 |  8   8              |  4  1e-40
%            RadauIIA-5-9-IRK  |  5 |  9   8   Y   Y   Y  |  5  1e-15
%              Gauss-6-12-IRK  |  6 | 12   8   Y   Y      |  6  1e-16
%
%
%------------------------------------------------------------
% Programmer(s):  Daniel R. Reynolds @ SMU
%------------------------------------------------------------
% Copyright (c) 2018, Southern Methodist University.
% All rights reserved.
% For details, see the LICENSE file.
%------------------------------------------------------------

% set anonymous function to handle behavior of double-vs-symbolic output
if ~exist('symbolic','var')
   symbolic = false;
end
if (symbolic)
   v = @(x) sym(x);
else
   v = @(x) double(x);
end

z = v(0);

% set the butcher table
if (strcmp(method_name,'DBM-5-3-ERK'))
   c = [z; v(0.1030620881159184); v(0.72139131281753662); v(1.28181117351981733); v(1) ];
   b = [ v(0.87795339639076672), v(-0.72692641526151549), v(0.7520413715737272), ...
         v(-0.22898029400415090), v(0.32591194130117246) ];
   A = [ z, z, z, z, z;
         v(0.10306208811591838), z, z, z, z;
         v(-0.94124866143519894), v(1.6626399742527356),  z, z, z;
         v(-1.3670975201437765),  v(1.3815852911016873),  v(1.2673234025619065),  z, z;
         v(-0.81287582068772448), v(0.81223739060505738), v(0.90644429603699305), ...
            v(0.094194134045674111), z ];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'DBM-5-3-ESDIRK'))
   c = [z; v(0.1030620881159184); v(0.72139131281753662); v(1.28181117351981733); v(1) ];
   b = [ v(0.87795339639076672), v(-0.72692641526151549), v(0.7520413715737272), ...
         v(-0.22898029400415090), v(0.32591194130117246) ];
   A = [ z, z, z, z, z;
         v(-0.22284985318525410),  v(0.32591194130117247), z, z, z;
         v(-0.46801347074080545),  v(0.86349284225716961), v(0.32591194130117247),  z, z;
         v(-0.46509906651927421),  v(0.81063103116959553), v(0.61036726756832357),  v(0.32591194130117245), z;
         v(0.87795339639076675), v(-0.72692641526151547), v(0.75204137157372720), ...
            v(-0.22898029400415088), v(0.32591194130117247) ];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'ARK3(2)4L[2]SA-ERK'))

   c = [z; v(1767732205903)/v(2027836641118); v(3)/v(5); v(1)];
   b = [v(1471266399579)/v(7840856788654), v(-4482444167858)/v(7529755066697), ...
      v(11266239266428)/v(11593286722821), v(1767732205903)/v(4055673282236)];
   b2 = [v(2756255671327)/v(12835298489170), v(-10771552573575)/v(22201958757719), ...
      v(9247589265047)/v(10645013368117), v(2193209047091)/v(5459859503100)];
   A = [z, z, z, z;
      v(1767732205903)/v(2027836641118), z, z, z;
      v(5535828885825)/v(10492691773637), v(788022342437)/v(10882634858940), z, z;
      v(6485989280629)/v(16251701735622), v(-4246266847089)/v(9704473918619), ...
          v(10755448449292)/v(10357097424841), z];
   q = 3;
   p = 2;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ARK3(2)4L[2]SA-ESDIRK'))

   c = [z; v(1767732205903)/v(2027836641118); v(3)/v(5); v(1)];
   b = [v(1471266399579)/v(7840856788654), v(-4482444167858)/v(7529755066697), ...
      v(11266239266428)/v(11593286722821), v(1767732205903)/v(4055673282236)];
   b2 = [v(2756255671327)/v(12835298489170), v(-10771552573575)/v(22201958757719),  ...
      v(9247589265047)/v(10645013368117), v(2193209047091)/v(5459859503100)];
   gamma = v(1767732205903)/v(4055673282236);
   A = [z, z, z, z;
      v(1767732205903)/v(4055673282236), gamma, z, z;
      v(2746238789719)/v(10658868560708), v(-640167445237)/v(6845629431997), gamma, z;
      v(1471266399579)/v(7840856788654), v(-4482444167858)/v(7529755066697), ...
          v(11266239266428)/v(11593286722821), gamma];
   q = 3;
   p = 2;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ARK4(3)6L[2]SA-ERK'))

   c = [z; v(1)/v(2); v(83)/v(250); v(31)/v(50); v(17)/v(20); v(1)];
   b = [v(82889)/v(524892), z, v(15625)/v(83664), v(69875)/v(102672), v(-2260)/v(8211), v(1)/v(4)];
   b2 = [v(4586570599)/v(29645900160), z, v(178811875)/v(945068544), ...
      v(814220225)/v(1159782912), v(-3700637)/v(11593932), v(61727)/v(225920)];
   A = [z, z, z, z, z, z;
      v(1)/v(2), z, z, z, z, z;
      v(13861)/v(62500), v(6889)/v(62500), z, z, z, z;
      v(-116923316275)/v(2393684061468), v(-2731218467317)/v(15368042101831), ...
          v(9408046702089)/v(11113171139209), z, z, z;
      v(-451086348788)/v(2902428689909), v(-2682348792572)/v(7519795681897), ...
          v(12662868775082)/v(11960479115383), v(3355817975965)/v(11060851509271), z, z;
      v(647845179188)/v(3216320057751), v(73281519250)/v(8382639484533), ...
          v(552539513391)/v(3454668386233), v(3354512671639)/v(8306763924573), ...
          v(4040)/v(17871), z];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ARK4(3)6L[2]SA-ESDIRK'))

   c = [z; v(1)/v(2); v(83)/v(250); v(31)/v(50); v(17)/v(20); v(1)];
   b = [v(82889)/v(524892), z, v(15625)/v(83664), v(69875)/v(102672), v(-2260)/v(8211), v(1)/v(4)];
   b2 = [v(4586570599)/v(29645900160), z, v(178811875)/v(945068544), ...
      v(814220225)/v(1159782912), v(-3700637)/v(11593932), v(61727)/v(225920)];
   A = [z, z, z, z, z, z;
      v(1)/v(4), v(1)/v(4), z, z, z, z;
      v(8611)/v(62500), v(-1743)/v(31250), v(1)/v(4), z, z, z;
      v(5012029)/v(34652500), v(-654441)/v(2922500), v(174375)/v(388108), v(1)/v(4), z, z;
      v(15267082809)/v(155376265600), v(-71443401)/v(120774400), v(730878875)/v(902184768), ...
         v(2285395)/v(8070912), v(1)/v(4), z;
      v(82889)/v(524892), z, v(15625)/v(83664), v(69875)/v(102672), v(-2260)/v(8211), v(1)/v(4)];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ESDIRK4(3)6L[2]SA'))

   % From: Table 16 of Kennedy & Carpenter, NASA/TM-2016-219173

   c = [z; v(1)/v(2); (v(2)-sqrt(v(2)))/v(4); v(5)/v(8); v(26)/v(25); v(1)];
   b = [(v(1181)-v(987)*sqrt(v(2)))/v(13782), (v(1181)-v(987)*sqrt(v(2)))/v(13782), v(47)*(-v(267)+v(1783)*sqrt(v(2)))/v(273343), -v(16)*(-v(22922)+v(3525)*sqrt(v(2)))/v(571953), -v(15625)*(v(97)+v(376)*sqrt(v(2)))/v(90749876), v(1)/v(4)];
   b2 = [-v(480923228411)/v(4982971448372), -v(480923228411)/v(4982971448372), v(6709447293961)/v(12833189095359), v(3513175791894)/v(6748737351361), -v(498863281070)/v(6042575550617), v(2077005547802)/v(8945017530137)];
   A = [z, z, z, z, z, z; ...
        v(1)/v(4), v(1)/v(4), z, z, z, z; ...
        (v(1)-sqrt(v(2)))/v(8), (v(1)-sqrt(v(2)))/v(8), v(1)/v(4), z, z, z; ...
        (v(5)-v(7)*sqrt(v(2)))/v(64), (v(5)-v(7)*sqrt(v(2)))/v(64), v(7)*(v(1)+sqrt(v(2)))/v(32), v(1)/v(4), z, z; ...
        -(v(13796)+v(54539)*sqrt(v(2)))/v(125000), -(v(13796)+v(54539)*sqrt(v(2)))/v(125000), (v(506605)+v(132109)*sqrt(v(2)))/v(437500), v(166)*(-v(97)+v(376)*sqrt(v(2)))/v(109375), v(1)/v(4), z; ...
        b];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ESDIRK4(3)7L[2]SA'))

   % From: Table 10 of Kennedy & Carpenter, Appl. Numer. Math., 2019

   c = [z; v(1)/v(4); v(1200237871921)/v(16391473681546); v(1)/v(2); v(395)/v(567); v(89)/v(126); v(1)];
   b = [z, -v(5649241495537)/v(14093099002237), v(5718691255176)/v(6089204655961), v(2199600963556)/v(4241893152925), v(8860614275765)/v(11425531467341), -v(3696041814078)/v(6641566663007), v(1)/v(8)];
   b(1) = v(1)-sum(b);
   d = [z, -v(1517409284625)/v(6267517876163), v(8291371032348)/v(12587291883523), v(5328310281212)/v(10646448185159), v(5405006853541)/v(7104492075037), -v(4254786582061)/v(7445269677723), v(19)/v(140)];
   d(1) = v(1)-sum(d);
   A = [z, z, z, z, z, z, z; ...
        z, v(1)/v(8), z, z, z, z, z; ...
        z, -v(39188347878)/v(1513744654945), v(1)/v(8), z, z, z, z; ...
        z, v(1748874742213)/v(5168247530883), -v(1748874742213)/v(5795261096931), v(1)/v(8), z, z, z; ...
        z, -v(6429340993097)/v(17896796106705), v(9711656375562)/v(10370074603625), v(1137589605079)/v(3216875020685), v(1)/v(8), z, z; ...
        z, v(405169606099)/v(1734380148729), -v(264468840649)/v(6105657584947), v(118647369377)/v(6233854714037), v(683008737625)/v(4934655825458), v(1)/v(8), z; ...
        b];
   A(2,1) = c(2)-sum(A(2,:));
   A(3,1) = c(3)-sum(A(3,:));
   A(4,1) = c(4)-sum(A(4,:));
   A(5,1) = c(5)-sum(A(5,:));
   A(6,1) = c(6)-sum(A(6,:));
   q = 4;
   p = 3;
   B = [c, A; q, b; p, d];

elseif (strcmp(method_name,'ESDIRK4(3I)6L[2]SA'))

   % From: Table 17 of Kennedy & Carpenter, NASA/TM-2016-219173

   c = [z; v(1)/v(2); (v(2)-sqrt(v(2)))/v(4); v(2012122486997)/v(3467029789466); v(1); v(1)];
   b = [v(657241292721)/v(9909463049845), v(657241292721)/v(9909463049845), v(1290772910128)/v(5804808736437), v(1103522341516)/v(2197678446715), -v(3)/v(28), v(1)/v(4)];
   b2 = [-v(71925161075)/v(3900939759889), -v(71925161075)/v(3900939759889), v(2973346383745)/v(8160025745289), v(3972464885073)/v(7694851252693), -v(263368882881)/v(4213126269514), v(3295468053953)/v(15064441987965)];
   A = [z, z, z, z, z, z; ...
        v(1)/v(4), v(1)/v(4), z, z, z, z; ...
        -v(1356991263433)/v(26208533697614), -v(1356991263433)/v(26208533697614), v(1)/v(4), z, z, z; ...
        -v(1778551891173)/v(14697912885533), -v(1778551891173)/v(14697912885533), v(7325038566068)/v(12797657924939), v(1)/v(4), z, z; ...
        -v(24076725932807)/v(39344244018142), -v(24076725932807)/v(39344244018142), v(9344023789330)/v(6876721947151), v(11302510524611)/v(18374767399840), v(1)/v(4), z; ...
        b];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'QESDIRK4(3)6L[2]SA'))

   % From: Table 20 of Kennedy & Carpenter, NASA/TM-2016-219173

   c = [z; v(16)/v(75); v(8)*(v(2)-sqrt(v(2)))/v(25); v(1298154247449)/v(2478647287318); v(11563539331134)/v(11078645848867); v(1)];
   b = [v(540088238697)/v(4693226184761), z, v(1094762490994)/v(7880993776667), v(4016564763003)/v(7185357966874), -v(411820258827)/v(3096789411938), v(8)/v(25)];
   b2 = [-v(374484326677)/v(8442488809460), -v(41125091159938)/v(25963879779069), v(24025088270494)/v(12927594097169), v(5193917461301)/v(8985383982321), -v(1843122001830)/v(16078617943063), v(2439572212972)/v(7960792257433)];
   A = [z, z, z, z, z, z; ...
        v(8)/v(75), v(8)/v(75), z, z, z, z; ...
        v(605497861978)/v(9136257189845), -v(2127848798551)/v(10702252975294), v(8)/v(25), z, z, z; ...
        -v(3005106686955)/v(6150333508049), -v(68662668193799)/v(11091168490809), v(80786898110822)/v(11737001380747), v(8)/v(25), z, z; ...
        -v(26162805558846)/v(8363194173203), -v(291987295964487)/v(9066074244437), v(384682892278670)/v(10959450712301), v(13555548451102)/v(14148104892819), v(8)/v(25), z; ...
        b];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'SDIRK4()5L[1]SA'))

  % From: Table 22 of Kennedy & Carpenter, NASA/TM-2016-219173

   c = [v(1)/v(4); (v(2)-sqrt(v(2)))/v(4); (v(13)+v(8)*sqrt(v(2)))/v(41); (v(41)+v(9)*sqrt(v(2)))/v(49); v(1)];
   b = [z, v(4)*(v(74)+v(273)*sqrt(v(2)))/v(5253), (v(19187)+v(5031)*sqrt(v(2)))/v(55284), (v(116092)-v(100113)*sqrt(v(2)))/v(334956), v(1)/v(4)];
   A = [v(1)/v(4), z, z, z, z; ...
        (v(1)-sqrt(v(2)))/v(4), v(1)/v(4), z, z, z; ...
        (-v(1676)+v(145)*sqrt(v(2)))/v(6724), v(3)*(v(709)+v(389)*sqrt(v(2)))/v(6724), v(1)/v(4), z, z; ...
        -(v(371435)+v(351111)*sqrt(v(2)))/v(470596), (v(98054928)+v(73894543)*sqrt(v(2)))/v(112001848), (v(56061972)+v(30241643)*sqrt(v(2)))/v(112001848), v(1)/v(4), z; ...
        b];
   q = 4;
   B = [c, A; q, b];

elseif (strcmp(method_name,'ESDIRK5(3)6L[2]SA'))

  % From: Table 23 of Kennedy & Carpenter, NASA/TM-2016-219173

   c = [z; v(4024571134387)/v(7237035672548); v(14228244952610)/v(13832614967709); v(1)/v(10); v(3)/v(50); v(1)];
   b = [-v(6225479754948)/v(6925873918471), v(6894665360202)/v(11185215031699), -v(2508324082331)/v(20512393166649), -v(7289596211309)/v(4653106810017), v(39811658682819)/v(14781729060964), v(3282482714977)/v(11805205429139)];
   b2 = [-v(2512930284403)/v(5616797563683), v(5849584892053)/v(8244045029872), -v(718651703996)/v(6000050726475), -v(18982822128277)/v(13735826808854), v(23127941173280)/v(11608435116569), v(2847520232427)/v(11515777524847)];
   A = [z, z, z, z, z, z; ...
        v(3282482714977)/v(11805205429139), v(3282482714977)/v(11805205429139), z, z, z, z; ...
        v(606638434273)/v(1934588254988), v(2719561380667)/v(6223645057524), v(3282482714977)/v(11805205429139), z, z, z; ...
        -v(651839358321)/v(6893317340882), -v(1510159624805)/v(11312503783159), v(235043282255)/v(4700683032009), v(3282482714977)/v(11805205429139), z, z; ...
        -v(5266892529762)/v(23715740857879), -v(1007523679375)/v(10375683364751), v(521543607658)/v(16698046240053), v(514935039541)/v(7366641897523), v(3282482714977)/v(11805205429139), z; ...
        b];
   q = 5;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'SDIRK5()5L[1]'))

  c = [v(4024571134387)/v(14474071345096); v(5555633399575)/v(5431021154178); v(5255299487392)/v(12852514622453); v(3)/v(20); v(10449500210709)/v(14474071345096)];
   b = [-v(2522702558582)/v(12162329469185), v(1018267903655)/v(12907234417901), v(4542392826351)/v(13702606430957), v(5001116467727)/v(12224457745473), v(1509636094297)/v(3891594770934)];
   A = [v(4024571134387)/v(14474071345096), z, z, z, z; ...
        v(9365021263232)/v(12572342979331), v(4024571134387)/v(14474071345096), z, z, z; ...
        v(2144716224527)/v(9320917548702), -v(397905335951)/v(4008788611757), v(4024571134387)/v(14474071345096), z, z; ...
        -v(291541413000)/v(6267936762551), v(226761949132)/v(4473940808273), -v(1282248297070)/v(9697416712681), v(4024571134387)/v(14474071345096), z; ...
        -v(2481679516057)/v(4626464057815), -v(197112422687)/v(6604378783090), v(3952887910906)/v(9713059315593), v(4906835613583)/v(8134926921134), v(4024571134387)/v(14474071345096)];
   q = 5;
   B = [c, A; q, b];

elseif (strcmp(method_name,'ESDIRK5(4)7L[2]SA'))

   % From: Table 25 of Kennedy & Carpenter, NASA/TM-2016-219173

   c = [z; v(46)/v(125); v(1518047795759)/v(14084074382095); v(13)/v(25); v(5906118540659)/v(9042400211275); v(26)/v(25); v(1)];
   b = [z, -v(1319096626979)/v(17356965168099), v(4356877330928)/v(10268933656267), v(922991294344)/v(3350617878647), v(4729382008034)/v(14755765856909), -v(308199069217)/v(5897303561678), v(23)/v(125)];
   b(1) = v(1)-sum(b);
   b2 = [z, -v(12068858301481)/v(111697653055985), v(30204157393951)/v(62440428688139), v(26156819792768)/v(110856972047457), v(33531609809941)/v(89326307438822), -v(18686091006953)/v(578397443530870), v(10582397456777)/v(69011126173064)];
   b2(1) = v(1)-sum(b2);
   A = [z, z, z, z, z, z, z; ...
        z, v(23)/v(125), z, z, z, z, z; ...
        z, -v(121529886477)/v(3189120653983), v(23)/v(125), z, z, z, z; ...
        z, v(186345625210)/v(8596203768457), v(3681435451073)/v(12579882114497), v(23)/v(125), z, z, z; ...
        z, -v(9898129553915)/v(11630542248213), v(19565727496993)/v(11159348038501), v(2073446517052)/v(4961027473423),  v(23)/v(125), z, z; ...
        z, -v(39752543191591)/v(7894275939720), v(52228808998390)/v(5821762529307), v(2756378382725)/v(8748785577174), v(17322065038796)/v(10556643942083), v(23)/v(125), z; ...
        b];
   A(2,1) = c(2)-sum(A(2,:));
   A(3,1) = c(3)-sum(A(3,:));
   A(4,1) = c(4)-sum(A(4,:));
   A(5,1) = c(5)-sum(A(5,:));
   A(6,1) = c(6)-sum(A(6,:));
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ESDIRK5(4)7L[2]SA2'))

   % From: Table 11 of Kennedy & Carpenter, Appl. Numer. Math., 2019

   c = [z;  v(46)/v(125); v(7121331996143)/v(11335814405378); v(49)/v(353); v(3706679970760)/v(5295570149437); v(347)/v(382); v(1)];
   b = [z, -v(188593204321)/(4778616380481), v(2809310203510)/v(10304234040467), v(1021729336898)/v(2364210264653),...
        v(870612361811)/v(2470410392208), -v(1307970675534)/v(8059683598661), v(23)/v(125)];
   b(1) = v(1)-sum(b);
   d = [z, -v(582099335757)/v(7214068459310), v(615023338567)/v(3362626566945), v(3192122436311)/v(6174152374399),...
        v(6156034052041)/v(14430468657929), -v(1011318518279)/v(9693750372484), v(1914490192573)/v(13754262428401)];
   d(1) = v(1)-sum(d);
   A = [z, z, z, z, z, z, z; ...
        z, v(23)/v(125), z, z, z, z, z; ...
        z, v(791020047304)/v(3561426431547), v(23)/v(125), z, z, z, z; ...
        z, -v(158159076358)/v(11257294102345), -v(85517644447)/v(5003708988389), v(23)/v(125), z, z, z; ...
        z, -v(1653327111580)/v(4048416487981), v(1514767744496)/v(9099671765375), v(14283835447591)/v(12247432691556), v(23)/v(125), z, z; ...
        z, -v(4540011970825)/v(8418487046959), -v(1790937573418)/v(7393406387169), v(10819093665085)/v(7266595846747), v(4109463131231)/v(7386972500302), v(23)/v(125), z; ...
        b];
   A(2,1) = c(2)-sum(A(2,:));
   A(3,1) = c(3)-sum(A(3,:));
   A(4,1) = c(4)-sum(A(4,:));
   A(5,1) = c(5)-sum(A(5,:));
   A(6,1) = c(6)-sum(A(6,:));
   q = 5;
   p = 4;
   B = [c, A; q, b; p, d];

elseif (strcmp(method_name,'ESDIRK5(4)8L[2]SA'))

   % From: Table 12 of Kennedy & Carpenter, Appl. Numer. Math., 2019
   % NOTE: \hat{b} has typos in their paper!!

   c = [z; v(2)/v(7); v(5779892736881)/v(11850239716711); v(150)/v(203); v(27)/v(46); v(473)/v(532); v(30)/v(83); v(1) ];
   b = [z, v(2162042939093)/v(22873479087181), -v(4222515349147)/v(9397994281350), v(3431955516634)/v(4748630552535), -v(374165068070)/v(9085231819471), -v(1847934966618)/v(8254951855109), v(5186241678079)/v(7861334770480), v(1)/v(7)];
   b(1) = v(1)-sum(b);
   d = [z, v(701879993119)/v(7084679725724), -v(8461269287478)/v(14654112271769), v(6612459227430)/v(11388259134383), v(2632441606103)/v(12598871370240), -v(2147694411931)/v(10286892713802), v(4103061625716)/v(6371697724583), v(4103061625716)/v(6371697724583)];
   d(1) = v(1)-sum(d);
   A = [z, z, z, z, z, z, z, z; ...
        z, v(1)/v(7), z, z, z, z, z, z; ...
        z, v(1521428834970)/v(8822750406821), v(1)/v(7), z, z, z, z, z; ...
        z, v(5338711108027)/v(29869763600956), v(1483184435021)/v(6216373359362), v(1)/v(7), z, z, z, z; ...
        z, v(2264935805846)/v(12599242299355), v(1330937762090)/v(13140498839569), -v(287786842865)/v(17211061626069), v(1)/v(7), z, z, z; ...
        z, v(118352937080)/v(527276862197), -v(2960446233093)/v(7419588050389), -v(3064256220847)/v(46575910191280), v(6010467311487)/v(7886573591137), v(1)/v(7), z, z; ...
        z, v(1134270183919)/v(9703695183946), v(4862384331311)/v(10104465681802), v(1127469817207)/v(2459314315538), -v(9518066423555)/v(11243131997224), -v(811155580665)/v(7490894181109), v(1)/v(7), z; ...
        b];
   A(2,1) = c(2)-sum(A(2,:));
   A(3,1) = c(3)-sum(A(3,:));
   A(4,1) = c(4)-sum(A(4,:));
   A(5,1) = c(5)-sum(A(5,:));
   A(6,1) = c(6)-sum(A(6,:));
   A(7,1) = c(7)-sum(A(7,:));
   q = 5;
   p = 4;
   B = [c, A; q, b; p, d];

elseif (strcmp(method_name,'ESDIRK6(4)7A[2]'))

   % From: Table 27 of Kennedy & Carpenter, NASA/TM-2016-219173
   % NOTE: row 7 of A has typos in their paper!!

   c = [z; v(5)/v(8); v(5)*(v(2)-sqrt(v(2)))/v(16); v(81)/v(100); v(89)/v(100); v(3)/v(20); v(11)/v(16)];
   b = [v(541976983222)/v(5570117184863), v(424517620289)/v(10281234581904), v(3004784109584)/v(2968823999583), -v(1080268266981)/v(2111416452515), v(3198291424887)/v(7137915940442), -v(6709580973937)/v(9894986011196), v(4328230890552)/v(7324362344791)];
   b2 = [v(23807813993)/v(6613359907661), v(122567156372)/v(6231407414731), v(5289947382915)/v(9624205771537), -v(132784415823)/v(2592433009541), v(2055455363695)/v(9863229933602), -v(686952476184)/v(6416474135057), v(2766631516579)/v(7339217152243)];
   A = [z, z, z, z, z, z, z; ...
        v(5)/v(16), v(5)/v(16), z, z, z, z, z; ...
        -v(6647797099592)/v(102714892273533), -v(6647797099592)/v(102714892273533), v(5)/v(16), z, z, z, z; ...
        -v(87265218833)/v(1399160431079), -v(87265218833)/v(1399160431079), v(3230569391728)/v(5191843160709), v(5)/v(16), z, z, z; ...
        -v(3742173976023)/v(7880396319491), -v(4537732256035)/v(9784784042546), v(32234033847818)/v(24636233068093), v(1995418204833)/v(9606020544314), v(5)/v(16), z, z; ...
         -v(460973220726)/v(7579441323155), -v(113988582459)/v(8174956167569), -v(679076942985)/v(7531712581924), v(1946214040135)/v(12392905069014), -v(2507263458377)/v(16215886710685), v(5)/v(16), z; ...
         2429030329867/4957732179206, -5124723475981/12913403568538, 3612624980699/11761071195830, 714493169479/5549220584147, -4586610949246/13858427945825, -4626134504839/7500671962341, 5/16];
   q = 6;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ESDIRK6(5)9L[2]SA'))

   % From: Table 13 of Kennedy & Carpenter, Appl. Numer. Math., 2019
   % NOTE: \hat{b} has typos in their paper!!

   c = [z; v(4)/v(9); v(376327483029687)/v(1335600577485745); v(433625707911282)/v(850513180247701); v(183)/v(200);...
        v(62409086037595)/v(296036819031271); v(81796628710131)/v(911762868125288); v(97)/v(100); v(1)];
   b = [z, z, z, v(281246836687281)/v(672805784366875), v(250674029546725)/v(464056298040646), v(88917245119922)/v(798581755375683), v(127306093275639)/v(658941305589808), -v(319515475352107)/v(658842144391777), v(2)/v(9)];
   d = [-v(204006714482445)/v(253120897457864), z, -v(818062434310719)/v(743038324242217), v(3176520686137389)/v(1064235527052079), -v(574817982095666)/v(1374329821545869), -v(507643245828272)/v(1001056758847831), v(2013538191006793)/v(972919262949000), v(352681731710820)/v(726444701718347), -v(12107714797721)/v(746708658438760)];
   A = [z, z, z, z, z, z, z, z, z;...
        v(2)/v(9), v(2)/v(9), z, z, z, z, z, z, z;...
        v(1)/v(9), -v(52295652026801)/v(1014133226193379), v(2)/v(9), z, z, z, z, z, z;...
        v(37633260247889)/v(456511413219805), -v(162541608159785)/v(642690962402252), v(186915148640310)/v(408032288622937), v(2)/v(9), z, z, z, z, z;...
        -v(37161579357179)/v(532208945751958), -v(211140841282847)/v(266150973773621), v(884359688045285)/v(894827558443789), v(845261567597837)/v(1489150009616527), v(2)/v(9), z, z, z, z;...
        v(32386175866773)/v(281337331200713), v(498042629717897)/v(1553069719539220), -v(73718535152787)/v(262520491717733), -v(147656452213061)/v(931530156064788), -v(16605385309793)/v(2106054502776008), v(2)/v(9), z, z, z;...
        -v(38317091100349)/v(1495803980405525), v(233542892858682)/v(880478953581929), -v(281992829959331)/v(709729395317651), -v(52133614094227)/v(895217507304839), -v(9321507955616)/v(673810579175161), v(79481371174259)/v(817241804646218), v(2)/v(9), z, z;...
        -v(486324380411713)/v(1453057025607868), -v(1085539098090580)/v(1176943702490991), v(370161554881539)/v(461122320759884), v(804017943088158)/v(886363045286999), -v(15204170533868)/v(934878849212545), -v(248215443403879)/v(815097869999138), v(339987959782520)/v(552150039467091), v(2)/v(9), z;...
       b];
   q = 6;
   p = 5;
   B = [c, A; q, b; p, d];

elseif (strcmp(method_name,'ESDIRK5(4I)8L[2]SA'))

   % From: Table 28 of Kennedy & Carpenter, NASA/TM-2016-219173
   % NOTE: row 7 of A has typos in their paper!!

   c = [z; v(1)/v(2); (v(2)+sqrt(v(2)))/v(4); v(53)/v(100); v(4)/v(5); v(17)/v(25); v(1); v(1)];
   b = [v(3148564786223)/v(23549948766475), -v(4152366519273)/v(20368318839251), -v(143958253112335)/v(33767350176582), v(16929685656751)/v(6821330976083), v(37330861322165)/v(4907624269821), -v(103974720808012)/v(20856851060343), -v(93596557767)/v(4675692258479), v(1)/v(4)];
   b2 = [v(1707112744407)/v(11125291145125), -v(34114578494)/v(9511465441463), -v(10730340352595)/v(5750059075211), v(16308974155447)/v(11154981868028), v(16015983083570)/v(4734398780449), -v(16745095336747)/v(7220642436550), -v(3941055932791)/v(7113931146175), v(9504350599766)/v(12768012822991)];
   A = [z, z, z, z, z, z, z, z; ...
        v(1)/v(4), v(1)/v(4), z, z, z, z, z, z; ...
        v(1748874742213)/v(5795261096931), v(1748874742213)/v(5795261096931), v(1)/v(4), z, z, z, z, z; ...
        v(2426486750897)/v(12677310711630), v(2426486750897)/v(12677310711630) -v(783385356511)/v(7619901499812), v(1)/v(4), z, z, z, z; ...
        v(1616209367427)/v(5722977998639), v(1616209367427)/v(5722977998639), -v(211896077633)/v(5134769641545), v(464248917192)/v(17550087120101), v(1)/v(4), z, z, z; ...
        v(1860464898611)/v(7805430689312), v(1825204367749)/v(7149715425471), -v(1289376786583)/v(6598860380111), v(55566826943)/v(2961051076052), v(1548994872005)/v(13709222415197), v(1)/v(4), z, z; ...
        1783640092711/14417713428467, -5781183663275/18946039887294, 57847255876685/10564937217081, 29339178902168/9787613280015, 122011506936853/12523522131766, -60418758964762/9539790648093, 1/4, z;...
        b];
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ARK4(3)7L[2]SA-ERK'))

   c = [z; v(247)/v(1000); v(4276536705230)/v(10142255878289); v(67)/v(200); v(3)/v(40); v(7)/v(10); v(1)];
   b = [z, z, v(9164257142617)/v(17756377923965), v(-10812980402763)/v(74029279521829), ...
       v(1335994250573)/v(5691609445217), v(2273837961795)/v(8368240463276), v(247)/v(2000)];
   b2 = [z, z, v(4469248916618)/v(8635866897933), v(-621260224600)/v(4094290005349), ...
        v(696572312987)/v(2942599194819), v(1532940081127)/v(5565293938103), v(2441)/v(20000)];
   A = [z, z, z, z, z, z, z;
        v(247)/v(1000), z, z, z, z, z, z;
        v(247)/v(4000), v(2694949928731)/v(7487940209513), z, z, z, z, z;
        v(464650059369)/v(8764239774964), v(878889893998)/v(2444806327765), ...
           v(-952945855348)/v(12294611323341), z, z, z, z;
        v(476636172619)/v(8159180917465), v(-1271469283451)/v(7793814740893), ...
           v(-859560642026)/v(4356155882851), v(1723805262919)/v(4571918432560), ...
           z, z, z;
        v(6338158500785)/v(11769362343261), v(-4970555480458)/v(10924838743837), ...
           v(3326578051521)/v(2647936831840), v(-880713585975)/v(1841400956686), ...
           v(-1428733748635)/v(8843423958496), z, z;
        v(760814592956)/v(3276306540349), v(760814592956)/v(3276306540349), ...
           v(-47223648122716)/v(6934462133451), v(71187472546993)/v(9669769126921), ...
           v(-13330509492149)/v(9695768672337), v(11565764226357)/v(8513123442827), z];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ARK4(3)7L[2]SA-ESDIRK'))

   gam = v(1235)/v(10000);
   c = [z; v(247)/v(1000); v(4276536705230)/v(10142255878289); v(67)/v(200); v(3)/v(40); v(7)/v(10); v(1)];
   b = [z, z, v(9164257142617)/v(17756377923965), v(-10812980402763)/v(74029279521829), ...
       v(1335994250573)/v(5691609445217), v(2273837961795)/v(8368240463276), v(247)/v(2000)];
   b2 = [z, z, v(4469248916618)/v(8635866897933), v(-621260224600)/v(4094290005349), ...
        v(696572312987)/v(2942599194819), v(1532940081127)/v(5565293938103), v(2441)/v(20000)];
   A = [z, z, z, z, z, z, z;
        gam, gam, z, z, z, z, z;
        v(624185399699)/v(4186980696204), v(624185399699)/v(4186980696204), gam, ...
           z, z, z, z;
        v(1258591069120)/v(10082082980243), v(1258591069120)/v(10082082980243), ...
           v(-322722984531)/v(8455138723562), gam, z, z, z;
        v(-436103496990)/v(5971407786587), v(-436103496990)/v(5971407786587), ...
           v(-2689175662187)/v(11046760208243), v(4431412449334)/v(12995360898505), gam, z, z;
        v(-2207373168298)/v(14430576638973), v(-2207373168298)/v(14430576638973), ...
           v(242511121179)/v(3358618340039), v(3145666661981)/v(7780404714551), ...
           v(5882073923981)/v(14490790706663), gam, z;
        z, z, v(9164257142617)/v(17756377923965), v(-10812980402763)/v(74029279521829), ...
           v(1335994250573)/v(5691609445217), v(2273837961795)/v(8368240463276), gam];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ARK5(4)8L[2]SA-ERK'))

   c = [z; v(41)/v(100); v(2935347310677)/v(11292855782101); ...
      v(1426016391358)/v(7196633302097); v(92)/v(100); v(24)/v(100); v(3)/v(5); v(1)];
   b = [v(-872700587467)/v(9133579230613), z, z, v(22348218063261)/v(9555858737531), ...
          v(-1143369518992)/v(8141816002931), v(-39379526789629)/v(19018526304540), ...
          v(32727382324388)/v(42900044865799), v(41)/v(200)];
   b2 = [v(-975461918565)/v(9796059967033), z, z, v(78070527104295)/v(32432590147079), ...
          v(-548382580838)/v(3424219808633), v(-33438840321285)/v(15594753105479), ...
          v(3629800801594)/v(4656183773603), v(4035322873751)/v(18575991585200)];
   A = [z, z, z, z, z, z, z, z;
        v(41)/v(100), z, z, z, z, z, z, z;
        v(367902744464)/v(2072280473677), v(677623207551)/v(8224143866563), z, z, z, z, z, z;
        v(1268023523408)/v(10340822734521), z, v(1029933939417)/ ...
            v(13636558850479), z, z, z, z, z;
        v(14463281900351)/v(6315353703477), z, v(66114435211212)/v(5879490589093), ...
            v(-54053170152839)/v(4284798021562), z, z, z, z;
        v(14090043504691)/v(34967701212078), z, v(15191511035443)/v(11219624916014), ...
            v(-18461159152457)/v(12425892160975), v(-281667163811)/ ...
            v(9011619295870), z, z, z;
        v(19230459214898)/v(13134317526959), z, v(21275331358303)/v(2942455364971), ...
            v(-38145345988419)/v(4862620318723), v(-1)/v(8), v(-1)/v(8), z, z;
        v(-19977161125411)/v(11928030595625), z, v(-40795976796054)/v(6384907823539), ...
            v(177454434618887)/v(12078138498510), v(782672205425)/v(8267701900261), ...
            v(-69563011059811)/v(9646580694205), v(7356628210526)/v(4942186776405), z];
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ARK5(4)8L[2]SA-ESDIRK'))

   c = [z; v(41)/v(100); v(2935347310677)/v(11292855782101); ...
      v(1426016391358)/v(7196633302097); v(92)/v(100); v(24)/v(100); v(3)/v(5); v(1)];
   b = [v(-872700587467)/v(9133579230613), z, z, v(22348218063261)/v(9555858737531), ...
          v(-1143369518992)/v(8141816002931), v(-39379526789629)/v(19018526304540), ...
          v(32727382324388)/v(42900044865799), v(41)/v(200)];
   b2 = [v(-975461918565)/v(9796059967033), z, z, v(78070527104295)/v(32432590147079), ...
          v(-548382580838)/v(3424219808633), v(-33438840321285)/v(15594753105479), ...
          v(3629800801594)/v(4656183773603), v(4035322873751)/v(18575991585200)];
   A = [z, z, z, z, z, z, z, z;
      v(41)/v(200), v(41)/v(200), z, z, z, z, z, z;
      v(41)/v(400), v(-567603406766)/v(11931857230679), v(41)/v(200), z, z, z, z, z;
      v(683785636431)/v(9252920307686), z, v(-110385047103)/ ...
          v(1367015193373), v(41)/v(200), z, z, z, z;
      v(3016520224154)/v(10081342136671), z, v(30586259806659)/v(12414158314087), ...
          v(-22760509404356)/v(11113319521817), v(41)/v(200), z, z, z;
      v(218866479029)/v(1489978393911), z, v(638256894668)/v(5436446318841), ...
          v(-1179710474555)/v(5321154724896), v(-60928119172)/ ...
          v(8023461067671), v(41)/v(200), z, z;
      v(1020004230633)/v(5715676835656), z, v(25762820946817)/v(25263940353407), ...
          v(-2161375909145)/v(9755907335909), v(-211217309593)/v(5846859502534), ...
          v(-4269925059573)/v(7827059040749), v(41)/v(200), z;
      v(-872700587467)/v(9133579230613), z, z, v(22348218063261)/v(9555858737531), ...
          v(-1143369518992)/v(8141816002931), v(-39379526789629)/v(19018526304540), ...
          v(32727382324388)/v(42900044865799), v(41)/v(200)];
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ARK5(4)8L[2]SAb-ERK'))

   gam = v(2)/v(9);
   c = [z; v(4)/v(9); v(6456083330201)/v(8509243623797); v(1632083962415)/v(14158861528103); ...
        v(6365430648612)/v(17842476412687); v(18)/v(25); v(191)/v(200); v(1)];
   b = [z, z, v(3517720773327)/v(20256071687669), v(4569610470461)/v(17934693873752), ...
        v(2819471173109)/v(11655438449929), v(3296210113763)/v(10722700128969), ...
        v(-1142099968913)/v(5710983926999), gam];
   b2 = [z, z, v(520639020421)/v(8300446712847), v(4550235134915)/v(17827758688493), ...
         v(1482366381361)/v(6201654941325), v(5551607622171)/v(13911031047899), ...
         v(-5266607656330)/v(36788968843917), v(1074053359553)/v(5740751784926)];
   A = [z, z, z, z, z, z, z, z;
        v(4)/v(9), z, z, z, z, z, z, z;
        v(1)/v(9), v(1183333538310)/v(1827251437969), z, z, z, z, z, z;
        v(895379019517)/v(9750411845327), v(477606656805)/v(13473228687314), ...
           v(-112564739183)/v(9373365219272), z, z, z, z, z;
        v(-4458043123994)/v(13015289567637), v(-2500665203865)/v(9342069639922), ...
           v(983347055801)/v(8893519644487), v(2185051477207)/v(2551468980502), ...
           z, z, z, z;
        v(-167316361917)/v(17121522574472), v(1605541814917)/v(7619724128744), ...
           v(991021770328)/v(13052792161721), v(2342280609577)/v(11279663441611), ...
           v(3012424348531)/v(12792462456678), z, z, z;
        v(6680998715867)/v(14310383562358), v(5029118570809)/v(3897454228471), ...
           v(2415062538259)/v(6382199904604), v(-3924368632305)/v(6964820224454), ...
           v(-4331110370267)/v(15021686902756), v(-3944303808049)/v(11994238218192), ...
           z, z;
        v(2193717860234)/v(3570523412979), v(2193717860234)/v(3570523412979), ...
           v(5952760925747)/v(18750164281544), v(-4412967128996)/v(6196664114337), ...
           v(4151782504231)/v(36106512998704), v(572599549169)/v(6265429158920), ...
           v(-457874356192)/v(11306498036315), z];
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ARK5(4)8L[2]SAb-ESDIRK'))

   gam = v(2)/v(9);
   c = [z; v(4)/v(9); v(6456083330201)/v(8509243623797); v(1632083962415)/v(14158861528103); ...
        v(6365430648612)/v(17842476412687); v(18)/v(25); v(191)/v(200); v(1)];
   b = [z, z, v(3517720773327)/v(20256071687669), v(4569610470461)/v(17934693873752), ...
        v(2819471173109)/v(11655438449929), v(3296210113763)/v(10722700128969), ...
        v(-1142099968913)/v(5710983926999), gam];
   b2 = [z, z, v(520639020421)/v(8300446712847), v(4550235134915)/v(17827758688493), ...
         v(1482366381361)/v(6201654941325), v(5551607622171)/v(13911031047899), ...
         v(-5266607656330)/v(36788968843917), v(1074053359553)/v(5740751784926)];
   A = [z, z, z, z, z, z, z, z;
        gam, gam, z, z, z, z, z, z;
        v(2366667076620)/v(8822750406821), v(2366667076620)/v(8822750406821), ...
           gam, z, z, z, z, z;
        v(-257962897183)/v(4451812247028), v(-257962897183)/v(4451812247028), ...
           v(128530224461)/v(14379561246022), gam, z, z, z, z;
        v(-486229321650)/v(11227943450093), v(-486229321650)/v(11227943450093), ...
           v(-225633144460)/v(6633558740617), v(1741320951451)/v(6824444397158), ...
           gam, z, z, z;
        v(621307788657)/v(4714163060173), v(621307788657)/v(4714163060173), ...
           v(-125196015625)/v(3866852212004), v(940440206406)/v(7593089888465), ...
           v(961109811699)/v(6734810228204), gam, z, z;
        v(2036305566805)/v(6583108094622), v(2036305566805)/v(6583108094622), ...
           v(-3039402635899)/v(4450598839912), v(-1829510709469)/v(31102090912115), ...
           v(-286320471013)/v(6931253422520), v(8651533662697)/v(9642993110008), ...
           gam, z;
        z, z, v(3517720773327)/v(20256071687669), v(4569610470461)/v(17934693873752), ...
           v(2819471173109)/v(11655438449929), v(3296210113763)/v(10722700128969), ...
           v(-1142099968913)/v(5710983926999), gam];
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Sayfy-Aburub-4-3-ERK'))

   A = [z, z, z, z, z, z; ...
        v(1)/v(2), z, z, z, z, z;
        v(-1), v(2), z, z, z, z;
        v(1)/v(6), v(2)/v(3), v(1)/v(6), z, z, z;
        v(0.137), v(0.226), v(0.137), z, z, z;
        v(0.452), v(-0.904), v(-0.548), z, v(2), z];
   b = [v(1)/v(6), v(1)/v(3), v(1)/v(12), z, v(1)/v(3), v(1)/v(12)];
   b2 = [v(1)/v(6), v(2)/v(3), v(1)/v(6), z, z, z];
   c = [z; v(1)/v(2); v(1); v(1); v(1)/v(2); v(1)];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Ascher(2,3,3)-ERK'))

   gamma = (v(3) + sqrt(v(3)))/v(6);
   c = [z; gamma; v(1)-gamma];
   b = [z, v(1)/v(2), v(1)/v(2)];
   A = [z,       z,           z;
        gamma,   z,           z;
        gamma-v(1), v(2)*(v(1)-gamma), z];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Ascher(2,3,3)-SDIRK'))

   gamma = (v(3) + sqrt(v(3)))/v(6);
   c = [z; gamma; v(1)-gamma];
   b = [z, v(1)/v(2), v(1)/v(2)];
   A = [z, z,         z;
        z, gamma,     z;
        z, v(1)-v(2)*gamma, gamma];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Ascher(2,3,2)-ERK'))

   gamma = (v(2)-sqrt(v(2)))/v(2);
   delta = -v(2)*sqrt(v(2))/v(3);
   c = [z; gamma; 1];
   b = [z, v(1)-gamma, gamma];
   A = [z, z, z;
        gamma, z, z;
        delta, v(1)-delta, z];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Ascher(2,3,2)-SDIRK'))

   gamma = (v(2)-sqrt(v(2)))/v(2);
   c = [z; gamma; v(1)];
   b = [z, v(1)-gamma, gamma];
   A = [z, z,       z;
        z, gamma,   z;
        z, v(1)-gamma, gamma];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Ascher(2,2,2)-ERK'))

   gamma = (v(2)-sqrt(v(2)))/v(2);
   delta = v(1)-v(1)/(v(2)*gamma);
   c = [z; gamma; v(1)];
   b = [delta, v(1)-delta, z];
   A = [z, z, z;
        gamma, z, z;
        delta, v(1)-delta, z];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Ascher(2,2,2)-SDIRK'))

   gamma = (v(2)-sqrt(v(2)))/v(2);
   c = [z; gamma; v(1)];
   b = [z, v(1)-gamma, gamma];
   A = [z, z,       z;
        z, gamma,   z;
        z, v(1)-gamma, gamma];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Ascher(3,4,3)-ERK'))

   gamma  = v(0.4358665215084589994160194511935568425293);
   gamma2 = gamma^2;

   b1 = -v(1.5) * gamma2 + v(4) * gamma - v(0.25);
   b2 =  v(1.5) * gamma2 - v(5) * gamma + v(1.25);

   a42 = v(0.5529291480359398193611887297385924764949);
   a43 = v(0.5529291480359398193611887297385924764949);

   a31 = (v(1) - v(4.5) * gamma + v(1.5) * gamma2) * a42 ...
       + (v(2.75) - v(10.5) * gamma + v(3.75) * gamma2) * a43 ...
       - v(3.5) + v(13) * gamma - v(4.5) * gamma2;

   a32 = (-v(1) + v(4.5) * gamma - v(1.5) * gamma2) * a42 ...
       + (-v(2.75) + v(10.5) * gamma - v(3.75) * gamma2) * a43 ...
       + v(4) - v(12.5) * gamma + v(4.5) * gamma2;

   a41 = v(1) - a42 - a43;

   c = [z; gamma; (v(1)+gamma)/v(2); v(1)];
   b = [z, b1, b2, gamma];
   A = [z,     z,   z,   z;
        gamma, z,   z,   z;
        a31,   a32, z,   z;
        a41,   a42, a43, z];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Ascher(3,4,3)-SDIRK'))

   gamma  = v(0.4358665215084589994160194511935568425293);
   gamma2 = gamma^2;

   b1 = -v(1.5) * gamma2 + v(4) * gamma - v(0.25);
   b2 =  v(1.5) * gamma2 - v(5) * gamma + v(1.25);

   c = [z; gamma; (v(1)+gamma)/v(2); v(1)];
   b = [z, b1, b2, gamma];
   A = [z,     z,           z,     z;
        z, gamma,           z,     z;
        z, (v(1)-gamma)/v(2), gamma,     z;
        z, b1,             b2, gamma];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Ascher(4,4,3)-ERK'))

   c = [z; v(1)/v(2); v(2)/v(3); v(1)/v(2); v(1)];
   b = [v(1)/v(4), v(7)/v(4), v(3)/v(4), v(-7)/v(4), z];
   A = [          z,          z,         z,          z, z;
          v(1)/v(2),          z,         z,          z, z;
        v(11)/v(18), v(1)/v(18),         z,          z, z;
          v(5)/v(6), v(-5)/v(6), v(1)/v(2),          z, z;
          v(1)/v(4),  v(7)/v(4), v(3)/v(4), v(-7)/v(4), z];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Ascher(4,4,3)-SDIRK'))

   c = [v(1)/v(2); v(2)/v(3); v(1)/v(2); v(1)];
   b = [v(3)/v(2), v(-3)/v(2), v(1)/v(2), v(1)/v(2)];
   A = [ v(1)/v(2),          z,         z,         z;
         v(1)/v(6),  v(1)/v(2),         z,         z;
        v(-1)/v(2),  v(1)/v(2), v(1)/v(2),         z;
         v(3)/v(2), v(-3)/v(2), v(1)/v(2), v(1)/v(2)];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Knoth-Wolke-ERK'))

   c = [z; v(1)/v(3); v(3)/v(4)];
   b = [v(1)/v(6), v(3)/v(10), v(8)/v(15)];
   A = [z, z, z;
        v(1)/v(3), z, z;
        v(-3)/v(16), v(15)/v(16), z];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'3/8-Rule-ERK'))

   c = [z; v(1)/v(3); v(2)/v(3); v(1)];
   b = [v(1)/v(8), v(3)/v(8), v(3)/v(8), v(1)/v(8)];
   A = [z, z, z, z;
        v(1)/v(3), z, z, z;
        v(-1)/v(3), v(1), z, z;
        v(1), v(-1), v(1), z];
   q = 4;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Cooper4-ERK'))

   c = [z; v(2)/v(3); v(2)/v(3); v(1)];
   b = [v(1)/v(4), v(1)/v(4), v(1)/v(2), z];
   A = [        z,         z,         z, z;
        v(2)/v(3),         z,         z, z;
        v(1)/v(6), v(1)/v(2),         z, z;
        v(1)/v(4), v(1)/v(4), v(1)/v(2), z];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Cooper4-ESDIRK'))

   c = [z; v(2)/v(3); v(2)/v(3); v(1)];
   b = [v(1)/v(4), v(1)/v(4), v(1)/v(2), z];
   A = [z, z, z, z;
        (v(1)-sqrt(v(3)))/v(6), (v(3)+sqrt(v(3)))/v(6), z, z;
        (v(5)+sqrt(v(3)))/v(12), -(v(1)+sqrt(v(3)))/v(4), (v(3)+sqrt(v(3)))/v(6), z;
        v(1)/v(4), v(1)/v(4), v(1)/v(2), z];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Cooper6-ERK'))

   c = [z; v(1)/v(2); v(1)/v(2); v(1)/v(2); v(1); v(1)];
   b = [v(1)/v(6), z, z, v(2)/v(3), v(1)/v(6), z];
   A = [z, z, z, z, z, z;
        v(1)/v(2), z, z, z, z, z;
        v(1)/v(4), v(1)/v(4), z, z, z, z;
        v(1)/v(4), v(1)/v(4), z, z, z, z;
        z, v(-1), z, v(2), z, z;
        v(1)/v(6), z, z, v(2)/v(3), v(1)/v(6), z];
   q = 5;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Cooper6-ESDIRK'))

   beta = v(1.0685790213);
   c = [z; v(1)/v(2); v(1)/v(2); v(1)/v(2); 1; 1];
   b = [v(1)/v(6), z, z, v(2)/v(3), v(1)/v(6), z];
   A = [z, z, z, z, z, z;
        (v(1)-v(2)*beta)/v(2), beta, z, z, z, z;
        v(1)/v(4), (v(1)-v(4)*beta)/v(4), beta, z, z, z;
        v(1)/v(4), beta/v(2), (v(1)-v(6)*beta)/v(4), beta, z, z;
        z, v(-2)*beta, (v(1)-v(6)*beta-v(8)*beta^2)/(v(1)-v(4)*beta), v(4)*beta/(v(1)-v(4)*beta), z, z;
        v(1)/v(6), z, z, v(2)/v(3), v(1)/v(6), z];
   q = 5;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Heun-Euler-ERK'))

   A = [ z, z; 1, z];
   b = [ v(0.5), v(0.5)];
   b2 = [ v(1), z];
   c = [ z; v(1)];
   q = 2;
   p = 1;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Bogacki-Shampine-ERK'))

   A = [z, z, z, z; v(1)/v(2), z, z, z; z, v(3)/v(4), z, z; v(2)/v(9), v(1)/v(3), v(4)/v(9), z];
   b = [v(2)/v(9), v(1)/v(3), v(4)/v(9), z];
   b2 = [v(7)/v(24), v(1)/v(4), v(1)/v(3), v(1)/v(8)];
   c = [z; v(1)/v(2); v(3)/v(4); v(1)];
   q = 3;
   p = 2;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Fehlberg-ERK'))

   A = [z, z, z, z, z, z; ...
        v(1)/v(4), z, z, z, z, z; ...
        v(3)/v(32), v(9)/v(32), z, z, z, z; ...
        v(1932)/v(2197), v(-7200)/v(2197), v(7296)/v(2197), z, z, z; ...
        v(439)/v(216), v(-8), v(3680)/v(513), v(-845)/v(4104), z, z; ...
        v(-8)/v(27), v(2), v(-3544)/v(2565), v(1859)/v(4104), v(-11)/v(40), z];
   b = [ v(16)/v(135), z, v(6656)/v(12825), v(28561)/v(56430), v(-9)/v(50), v(2)/v(55)];
   b2 = [ v(25)/v(216), z, v(1408)/v(2565), v(2197)/v(4104), v(-1)/v(5), z];
   c = [ z; v(1)/v(4); v(3)/v(8); v(12)/v(13); v(1); v(1)/v(2)];
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Cash-Karp-ERK'))

   A = [ z, z, z, z, z, z; ...
         v(1)/v(5), z, z, z, z, z; ...
         v(3)/v(40), v(9)/v(40), z, z, z, z; ...
         v(3)/v(10), v(-9)/v(10), v(6)/v(5), z, z, z; ...
         v(-11)/v(54), v(5)/v(2), v(-70)/v(27), v(35)/v(27), z, z; ...
         v(1631)/v(55296), v(175)/v(512), v(575)/v(13824), v(44275)/v(110592), v(253)/v(4096), z];
   b = [ v(37)/v(378), z, v(250)/v(621), v(125)/v(594), z, v(512)/v(1771)];
   b2 = [ v(2825)/v(27648), z, v(18575)/v(48384), v(13525)/v(55296), v(277)/v(14336), v(1)/v(4)];
   c = [ z; v(1)/v(5); v(3)/v(10); v(3)/v(5); v(1); v(7)/v(8)];
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Dormand-Prince-ERK'))

   A = [ z, z, z, z, z, z, z; ...
         v(1)/v(5), z, z, z, z, z, z; ...
         v(3)/v(40), v(9)/v(40), z, z, z, z, z; ...
         v(44)/v(45), v(-56)/v(15), v(32)/v(9), z, z, z, z; ...
         v(19372)/v(6561), v(-25360)/v(2187), v(64448)/v(6561), v(-212)/v(729), z, z, z; ...
         v(9017)/v(3168), v(-355)/v(33), v(46732)/v(5247), v(49)/v(176), v(-5103)/v(18656), z, z; ...
         v(35)/v(384), z, v(500)/v(1113), v(125)/v(192), v(-2187)/v(6784), v(11)/v(84), z];
   b = [ v(35)/v(384), z, v(500)/v(1113), v(125)/v(192), v(-2187)/v(6784), v(11)/v(84), z];
   b2 = [v(5179)/v(57600), z, v(7571)/v(16695), v(393)/v(640), v(-92097)/v(339200), v(187)/v(2100), v(1)/v(40)];
   c = [ z; v(1)/v(5); v(3)/v(10); v(4)/v(5); v(8)/v(9); v(1); v(1)];
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'TRBDF2-ESDIRK'))

   A = [z, z, z; ...
      (v(2)-sqrt(v(2)))/v(2), (v(2)-sqrt(v(2)))/v(2), z; ...
      sqrt(v(2))/v(4), sqrt(v(2))/v(4), (v(2)-sqrt(v(2)))/v(2)];
   b = [sqrt(v(2))/v(4), sqrt(v(2))/v(4), (v(2)-sqrt(v(2)))/v(2)];
   b2 = [(v(1)-sqrt(v(2))/v(4))/v(3), (v(3)*sqrt(v(2))/v(4)+v(1))/v(3), (v(2)-sqrt(v(2)))/v(6)];
   c = [z; v(2)-sqrt(v(2)); v(1)];
   q = 2;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'TRX2-ESDIRK'))

   A = [ z, z, z; v(0.25), v(0.25), z; v(0.25), v(0.5), v(0.25)];
   b = [ v(0.25), v(0.5), v(0.25)];
   b2 = [ v(1)/v(6), v(2)/v(3), v(1)/v(6)];
   c = [ z; v(0.5); v(1)];
   q = 2;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Billington-SDIRK'))

   A = [v(0.292893218813), z, z; ...
        v(0.798989873223), v(0.292893218813), z; ...
        v(0.740789228841), v(0.259210771159), v(0.292893218813)];
   b = [ v(0.740789228840), v(0.259210771159), z];
   b2 = [ v(0.691665115992), v(0.503597029883), v(-0.195262145876)];
   c = [ v(0.292893218813); v(1.091883092037); v(1.292893218813)];
   q = 2;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Cash(5,2,4)-SDIRK'))

   A = [v(0.435866521508), z, z, z, z; ...
        v(-1.13586652150), v(0.435866521508), z, z, z; ...
        v(1.08543330679), v(-0.721299828287), v(0.435866521508), z, z; ...
        v(0.416349501547), v(0.190984004184), v(-0.118643265417), v(0.435866521508), z; ...
        v(0.896869652944), v(0.0182725272734), v(-0.0845900310706), ...
            v(-0.266418670647), v(0.435866521508)];
   b = [v(0.896869652944), v(0.0182725272734), v(-0.0845900310706), ...
          v(-0.266418670647), v(0.435866521508)];
   b2 = [(-v(0.7)-v(0.5))/(-v(0.7)-v(0.435866521508)), ...
          (v(0.5)-v(0.435866521508))/(-v(0.7)-v(0.435866521508)), z, z, z];
   c = [v(0.435866521508); v(-0.7); v(0.8); v(0.924556761814); v(1)];
   q = 4;
   p = 2;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Cash(5,3,4)-SDIRK'))

   A = [v(0.435866521508), z, z, z, z; ...
        v(-1.13586652150), v(0.435866521508), z, z, z; ...
        v(1.08543330679), v(-0.721299828287), v(0.435866521508), z, z; ...
        v(0.416349501547), v(0.190984004184), v(-0.118643265417), v(0.435866521508), z;...
        v(0.896869652944), v(0.0182725272734), v(-0.0845900310706), ...
          v(-0.266418670647), v(0.435866521508)];
   b = [v(0.896869652944), v(0.0182725272734), v(-0.0845900310706), ...
          v(-0.266418670647), v(0.435866521508)];
   b2 = [v(0.776691932910), v(0.0297472791484), v(-0.0267440239074), v(0.220304811849), z];
   c = [v(0.435866521508); v(-0.7); v(0.8); v(0.924556761814); v(1)];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Kvaerno(4,2,3)-ESDIRK'))

   A = [z, z, z, z; ...
        v(0.4358665215), v(0.4358665215), z, z; ...
        v(0.490563388419108), v(0.073570090080892), v(0.4358665215), z; ...
        v(0.308809969973036), v(1.490563388254106), v(-1.235239879727145), v(0.4358665215)];
   b = [v(0.308809969973036), v(1.490563388254106), v(-1.235239879727145), v(0.4358665215)];
   b2 = [v(0.490563388419108), v(0.073570090080892), v(0.4358665215), z];
   c = [z; v(0.871733043); v(1); v(1)];
   q = 3;
   p = 2;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Kvaerno(5,3,4)-ESDIRK'))

   A = [z, z, z, z, z; ...
        v(0.4358665215), v(0.4358665215), z, z, z; ...
        v(0.140737774731968), v(-0.108365551378832), v(0.4358665215), z, z;...
        v(0.102399400616089), v(-0.376878452267324), v(0.838612530151233), v(0.4358665215), z;...
        v(0.157024897860995), v(0.117330441357768), v(0.61667803039168), v(-0.326899891110444), v(0.4358665215)];
   b = [v(0.157024897860995), v(0.117330441357768), v(0.61667803039168), v(-0.326899891110444), v(0.4358665215)];
   b2 = [v(0.102399400616089), v(-0.376878452267324), v(0.838612530151233), v(0.4358665215), z];
   c = [z; v(0.871733043); v(0.468238744853136); v(1); v(1)];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Kvaerno(7,4,5)-ESDIRK'))

   A = [z, z, z, z, z, z, z; ...
        v(0.26), v(0.26), z, z, z, z, z; ...
        v(0.13), v(0.84033320996790809), v(0.26), z, z, z, z; ...
        v(0.22371961478320505), v(0.47675532319799699), v(-0.06470895363112615), v(0.26), z, z, z; ...
        v(0.16648564323248321), v(0.10450018841591720), v(0.03631482272098715), v(-0.13090704451073998), v(0.26), z, z; ...
        v(0.13855640231268224), z, v(-0.04245337201752043), v(0.02446657898003141), v(0.61943039072480676), v(0.26), z; ...
        v(0.13659751177640291), z, v(-0.05496908796538376), v(-0.04118626728321046), v(0.62993304899016403), v(0.06962479448202728), v(0.26)];

   b = [v(0.13659751177640291), z, v(-0.05496908796538376), v(-0.04118626728321046), v(0.62993304899016403), v(0.06962479448202728), v(0.26)];
   b2 = [v(0.13855640231268224), z, v(-0.04245337201752043), v(0.02446657898003141), v(0.61943039072480676), v(0.26), z];
   c = [z; v(0.52); v(1.230333209967908); v(0.895765984350076); v(0.436393609858648); v(1); v(1)];
   q = 5;
   p = 4;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ERK-1-1'))   % explicit Euler

   A = [z];
   b = [v(1)];
   c = [z];
   q = 1;
   B = [c, A; q, b];

elseif (strcmp(method_name,'ERK-2-2'))   % Ralston's method, doi: 10.1090/S0025-5718-1962-0150954-0

   A = [ z, z; v(2)/v(3), z];
   b = [ v(1)/v(4), v(3)/v(4)];
   c = [ z; v(2)/v(3)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'ERK-3-3'))

   A = [ z, z, z; v(1)/v(2), z, z; v(-1), v(2), z];
   b = [ v(1)/v(6), v(2)/v(3), v(1)/v(6)];
   b2 = [z, v(1), z];
   c = [ z; v(1)/v(2); v(1)];
   q = 3;
   p = 2;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ERK-4-4'))

   A = [z, z, z, z; v(1)/v(2), z, z, z; z, v(1)/v(2), z, z; z, z, v(1), z];
   b = [v(1)/v(6), v(1)/v(3), v(1)/v(3), v(1)/v(6)];
   c = [z; v(1)/v(2); v(1)/v(2); v(1)];
   q = 4;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Butcher-7-6-ERK'))

   A = [z, z, z, z, z, z, z;
       v(1)/v(3), z, z, z, z, z, z;
       z, v(2)/v(3), z, z, z, z, z;
       v(1)/v(12), v(1)/v(3), -v(1)/v(12), z, z, z, z;
       v(25)/v(48), -v(55)/v(24), v(35)/v(48), v(15)/v(8), z, z, z;
       v(3)/v(20), -v(11)/v(24), -v(1)/v(8), v(1)/v(2), v(1)/v(10), z, z;
       -v(261)/v(260), v(33)/v(13), v(43)/v(156), -v(118)/v(39), v(32)/v(195), v(80)/v(39), z];
   b = [v(13)/v(200), z, v(11)/v(40), v(11)/v(40), v(4)/v(25), v(4)/v(25), v(13)/v(200)];
   c = [z; v(1)/v(3); v(2)/v(3); v(1)/v(3); v(5)/v(6); v(1)/v(6); v(1)];
   q = 6;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Butcher-7-6b-ERK'))

   A = [z, z, z, z, z, z, z;
        v(2)/v(5), z, z, z, z, z, z;
        z, v(4)/v(5), z, z, z, z, z;
        v(169)/v(1458), v(110)/v(729), -v(65)/v(1458), z, z, z, z;
        -v(44)/v(675), -v(88)/v(135), v(76)/v(351), v(336)/v(325), z, z, z;
        v(21)/v(106), z, -v(105)/v(689), -v(324)/v(689), v(45)/v(106), z, z;
        -v(2517)/v(4864), -v(55)/v(38), v(10615)/v(31616), v(567)/v(7904), v(7245)/v(4864), v(2597)/v(2432), z];
   b = [z, z, v(1375)/v(4992), v(6561)/v(20384), v(3375)/v(12544), v(53)/v(768), v(19)/v(294)];
   c = [z; v(2)/v(5); v(4)/v(5); v(2)/v(9); v(8)/v(15); z; v(1)];
   q = 6;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Butcher-9-7-ERK'))

   A = [z, z, z, z, z, z, z, z, z;
        v(1)/v(6), z, z, z, z, z, z, z, z;
        z, v(1)/v(3), z, z, z, z, z, z, z;
        v(1)/v(8), z, v(3)/v(8), z, z, z, z, z, z;
        v(148)/v(1331), z, v(150)/v(1331), -v(56)/v(1331), z, z, z, z, z;
        -v(404)/v(243), z, -v(170)/v(27), v(4024)/v(1701), v(10648)/v(1701), z, z, z, z;
        v(2466)/v(2401), z, v(1242)/v(343), -v(19176)/v(16807), -v(51909)/v(16807), v(1053)/v(2401), z, z, z;
        v(5)/v(154), z, z, v(96)/v(539), -v(1815)/v(20384), -v(405)/v(2464), v(49)/v(1144), z, z;
        -v(113)/v(32), z, -v(195)/v(22), v(32)/v(7), v(29403)/v(3584), -v(729)/v(512), v(1029)/v(1408), v(21)/v(16), z];
   b = [z, z, z, v(32)/v(105), v(1771561)/v(6289920), v(243)/v(2560), v(16807)/v(74880), v(77)/v(1440), v(11)/v(270)];
   c = [z; v(1)/v(6); v(1)/v(3); v(1)/v(2); v(2)/v(11); v(2)/v(3); v(6)/v(7); z; v(1)];
   q = 7;
   B = [c, A; q, b];

elseif (strcmp(method_name,'CooperVerner-11-8-ERK'))

   s21 = sqrt(21);
   A = [z, z, z, z, z, z, z, z, z, z, z;
        v(1)/v(2), z, z, z, z, z, z, z, z, z, z;
        v(1)/v(4), v(1)/v(4), z, z, z, z, z, z, z, z, z;
        v(1)/v(7), (-v(7)-3*s21)/98, (v(21)+5*s21)/49, z, z, z, z, z, z, z, z;
        (v(11)+s21)/84, z, (v(18)+4*s21)/63, (v(21)-s21)/252, z, z, z, z, z, z, z;
        (v(5)+s21)/48, z, (v(9)+s21)/36, (-v(231)+14*s21)/360, (v(63)-7*s21)/80, z, z, z, z, z, z;
        (v(10)-s21)/42, z, (-v(432)+92*s21)/315, (v(633)-145*s21)/90, (-v(504)+115*s21)/70, (v(63)-13*s21)/35, z, z, z, z, z;
        v(1)/v(14), z, z, z, (v(14)-3*s21)/126, (v(13)-3*s21)/63, v(1)/v(9), z, z, z, z;
        v(1)/v(32), z, z, z, (v(91)-21*s21)/576, v(11)/v(72), (-v(385)-75*s21)/1152, (v(63)+13*s21)/128, z, z, z;
        v(1)/v(14), z, z, z, v(1)/v(9), (-v(733)-147*s21)/2205, (v(515)+111*s21)/504, (-v(51)-11*s21)/56, (v(132)+28*s21)/245, z, z;
        z, z, z, z, (-v(42)+7*s21)/18, (-v(18)+28*s21)/45, (-v(273)-53*s21)/72, (v(301)+53*s21)/72, (v(28)-28*s21)/45, (v(49)-7*s21)/18, z];
   b = [v(1)/v(20), z, z, z, z, z, z, v(49)/v(180), v(16)/v(45), v(49)/v(180), v(1)/v(20)];
   c = [z; v(1)/v(2); v(1)/v(2); (v(7)+s21)/14; (v(7)+s21)/14; v(1)/v(2); (v(7)-s21)/14; (v(7)-s21)/14; v(1)/v(2); (v(7)+s21)/14; v(1)];
   q = 8;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Merson-4-3-ERK'))

   A = [z, z, z, z, z; v(1)/v(3), z, z, z, z; v(1)/v(6), v(1)/v(6), z, z, z; ...
        v(1)/v(8), z, v(3)/v(8), z, z; v(1)/v(2), z, v(-3)/v(2), v(2), z];
   b = [v(1)/v(6), z, z, v(2)/v(3), v(1)/v(6)];
   b2 = [v(1)/v(10), z, v(3)/v(10), v(2)/v(5), v(1)/v(5)];
   c = [z; v(1)/v(3); v(1)/v(3); v(1)/v(2); v(1)];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Zonneveld-4-3-ERK'))

   A = [z, z, z, z, z; v(1)/v(2), z, z, z, z; z, v(1)/v(2), z, z, z; ...
        z, z, v(1), z, z; v(5)/v(32), v(7)/v(32), v(13)/v(32), v(-1)/v(32), z];
   b = [v(1)/v(6), v(1)/v(3), v(1)/v(3), v(1)/v(6), z];
   b2 = [v(-1)/v(2), v(7)/v(3), v(7)/v(3), v(13)/v(6), v(-16)/v(3)];
   c = [z; v(1)/v(2); v(1)/v(2); v(1); v(3)/v(4)];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];


elseif (strcmp(method_name,'Verner-6-5-ERK'))

   A = [z, z, z, z, z, z, z, z; ...
        v(1)/v(6), z, z, z, z, z, z, z; ...
        v(4)/v(75), v(16)/v(75), z, z, z, z, z, z; ...
        v(5)/v(6), v(-8)/v(3), v(5)/v(2), z, z, z, z, z; ...
        v(-165)/v(64), v(55)/v(6), v(-425)/v(64), v(85)/v(96), z, z, z, z; ...
        v(12)/v(5), v(-8), v(4015)/v(612), v(-11)/v(36), v(88)/v(255), z, z, z; ...
        v(-8263)/v(15000), v(124)/v(75), v(-643)/v(680), v(-81)/v(250), v(2484)/v(10625), z, z, z; ...
        v(3501)/v(1720), v(-300)/v(43), v(297275)/v(52632), v(-319)/v(2322), v(24068)/v(84065), z, v(3850)/v(26703), z];
   b = [v(3)/v(40), z, v(875)/v(2244), v(23)/v(72), v(264)/v(1955), z, v(125)/v(11592), v(43)/v(616)];
   b2 = [v(13)/v(160), z, v(2375)/v(5984), v(5)/v(16), v(12)/v(85), v(3)/v(44), z, z];

   c = [z; v(1)/v(6); v(4)/v(15); v(2)/v(3); v(5)/v(6); v(1); v(1)/v(15); v(1)];
   q = 6;
   p = 5;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Fehlberg-8-7-ERK'))

   A = [z, z, z, z, z, z, z, z, z, z, z, z, z; ...
        v(2)/v(27), z, z, z, z, z, z, z, z, z, z, z, z; ...
        v(1)/v(36), v(1)/v(12), z, z, z, z, z, z, z, z, z, z, z; ...
        v(1)/v(24), z, v(1)/v(8), z, z, z, z, z, z, z, z, z, z; ...
        v(5)/v(12), z, v(-25)/v(16), v(25)/v(16), z, z, z, z, z, z, z, z, z; ...
        v(1)/v(20), z, z, v(1)/v(4), v(1)/v(5), z, z, z, z, z, z, z, z; ...
        v(-25)/v(108), z, z, v(125)/v(108), v(-65)/v(27), v(125)/v(54), z, z, z, z, z, z, z; ...
        v(31)/v(300), z, z, z, v(61)/v(225), v(-2)/v(9), v(13)/v(900), z, z, z, z, z, z; ...
        v(2), z, z, v(-53)/v(6), v(704)/v(45), v(-107)/v(9), v(67)/v(90), v(3), z, z, z, z, z; ...
        v(-91)/v(108), z, z, v(23)/v(108), v(-976)/v(135), v(311)/v(54), v(-19)/v(60), v(17)/v(6), v(-1)/v(12), z, z, z, z; ...
        v(2383)/v(4100), z, z, v(-341)/v(164), v(4496)/v(1025), v(-301)/v(82), v(2133)/v(4100), v(45)/v(82), v(45)/v(164), v(18)/v(41), z, z, z; ...
        v(3)/v(205), z, z, z, z, v(-6)/v(41), v(-3)/v(205), v(-3)/v(41), v(3)/v(41), v(6)/v(41), z, z, z; ...
        v(-1777)/v(4100), z, z, v(-341)/v(164), v(4496)/v(1025), v(-289)/v(82), v(2193)/v(4100), v(51)/v(82), v(33)/v(164), v(12)/v(41), z, v(1), z];
   b = [z, z, z, z, z, v(34)/v(105), v(9)/v(35), v(9)/v(35), v(9)/v(280), v(9)/v(280), z, v(41)/v(840), v(41)/v(840)];
   b2 = [v(41)/v(840), z, z, z, z, v(34)/v(105), v(9)/v(35), v(9)/v(35), v(9)/v(280), v(9)/v(280), v(41)/v(840), z, z];

   c = [z; v(2)/v(27); v(1)/v(9); v(1)/v(6); v(5)/v(12); v(1)/v(2); v(5)/v(6); v(1)/v(6); v(2)/v(3); v(1)/v(3); v(1); z; v(1)];
   q = 8;
   p = 7;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'SDIRK-2-2'))

   A = [v(1)-v(1)/sqrt(v(2)), z; v(1)/sqrt(v(2)), v(1)-v(1)/sqrt(v(2))];
   b = [ v(1)/sqrt(v(2)), v(1) - v(1)/sqrt(v(2))];
   b2 = [ -v(1)/sqrt(v(2)), v(1)+v(1)/sqrt(v(2)) ];
   c = [ v(1)-v(1)/sqrt(v(2)); v(1)];
   q = 2;
   p = 1;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'SDIRK-2-1'))

   A = [v(1), z; v(-1), v(1)];
   b = [ v(1)/v(2), v(1)/v(2)];
   b2 = [ v(1), z];
   c = [ v(1); z];
   q = 2;
   p = 1;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'IRK-1-1'))

   c = [v(1)];
   b = [v(1)];
   A = [v(1)];
   q = 1;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Crank-Nicolson-2-2-IRK'))

   A = [ v(1)/v(2), v(1)/v(2); z, z];
   b = [ v(1)/v(2), v(1)/v(2)];
   c = [ v(1); z];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SIRK-2-2'))

   A = [(v(5)-v(3)*sqrt(v(2)))/v(4), (v(7)-v(5)*sqrt(v(2)))/v(4); ...
        (v(1)+v(1)*sqrt(v(2)))/v(4), (v(3)-v(1)*sqrt(v(2)))/v(4)];
   b = [ (v(1)+v(1)*sqrt(v(2)))/v(4), (v(3)-v(1)*sqrt(v(2)))/v(4)];
   c = [ v(3)-v(2)*sqrt(v(2)); v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Gauss-2-4-IRK'))

   A = [v(1)/v(4), v(1)/v(4)-sqrt(v(3))/v(6); v(1)/v(4)+sqrt(v(3))/v(6), v(1)/v(4)];
   b = [v(1)/v(2), v(1)/v(2)];
   c = [v(1)/v(2)-sqrt(v(3))/v(6); v(1)/v(2)+sqrt(v(3))/v(6)];
   q = 4;
   B = [c, A; q, b];

elseif (strcmp(method_name,'RadauIIA-2-3-IRK'))

   A = [v(5)/v(12), v(-1)/v(12); v(9)/v(12), v(3)/v(12)];
   b = [v(3)/v(4), v(1)/v(4)];
   c = [v(1)/v(3); v(1)];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIII-2-2-IRK'))

   A = [z, z; v(1), z];
   b = [v(1)/v(2), v(1)/v(2)];
   c = [z; v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIA-2-2-IRK'))

   A = [ z, z; v(1)/v(2), v(1)/v(2)];
   b = [ v(1)/v(2), v(1)/v(2)];
   c = [ z; v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIC-2-2-IRK'))

   A = [ v(1)/v(2), v(-1)/v(2); v(1)/v(2), v(1)/v(2)];
   b = [ v(1)/v(2), v(1)/v(2)];
   c = [ z; v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'Gauss-3-6-IRK'))

   A = [v(5)/v(36), v(2)/v(9)-sqrt(v(15))/v(15), v(5)/v(36)-sqrt(v(15))/v(30); ...
      v(5)/v(36)+sqrt(v(15))/v(24), v(2)/v(9), v(5)/v(36)-sqrt(v(15))/v(24); ...
      v(5)/v(36)+sqrt(v(15))/v(30), v(2)/v(9)+sqrt(v(15))/v(15), v(5)/v(36)];
   c = [v(0.5)-sqrt(v(15))/v(10); v(0.5); v(0.5)+sqrt(v(15))/v(10)];
   b = [v(5)/v(18), v(8)/v(18), v(5)/v(18)];
   q = 6;
   B = [c, A; q, b];

elseif (strcmp(method_name,'RadauI-3-5-IRK'))

   A = [z, z, z; ...
      (v(9)+sqrt(v(6)))/v(75), (v(24)+sqrt(v(6)))/v(120), (v(168)-v(73)*sqrt(v(6)))/v(600); ...
      (v(9)-sqrt(v(6)))/v(75), (v(168)+v(73)*sqrt(v(6)))/v(600), (v(24)-sqrt(v(6)))/v(120)];
   b = [v(1)/v(9), (v(16)+sqrt(v(6)))/v(36), (v(16)-sqrt(v(6)))/v(36)];
   c = [z; (v(6)-sqrt(v(6)))/v(10); (v(6)+sqrt(v(6)))/v(10)];
   q = 5;
   B = [c, A; q, b];

elseif (strcmp(method_name,'RadauIA-3-5-IRK'))

   A = [v(1)/v(9), -(v(1)+sqrt(v(6)))/v(18), -(v(1)-sqrt(v(6)))/v(18); ...
      v(1)/v(9), (v(88)+v(7)*sqrt(v(6)))/v(360), (v(88)-v(43)*sqrt(v(6)))/v(360); ...
      v(1)/v(9), (v(88)+v(43)*sqrt(v(6)))/v(360), (v(88)-v(7)*sqrt(v(6)))/v(360)];
   b = [v(1)/v(9), (v(16)+sqrt(v(6)))/v(36), (v(16)-sqrt(v(6)))/v(36)];
   c = [z; (v(6)-sqrt(v(6)))/v(10); (v(6)+sqrt(v(6)))/v(10)];
   q = 5;
   B = [c, A; q, b];

elseif (strcmp(method_name,'RadauII-3-5-IRK'))

   A = [(v(24)-sqrt(v(6)))/v(120), (v(24)-v(11)*sqrt(v(6)))/v(120), z; ...
      (v(24)+v(11)*sqrt(v(6)))/v(120), (v(24)+sqrt(v(6)))/v(120), z; ...
      (v(6)-sqrt(v(6)))/v(12), (v(6)+sqrt(v(6)))/v(12), z];
   b = [(v(16)-sqrt(v(6)))/v(36), (v(16)+sqrt(v(6)))/v(36), v(1)/v(9)];
   c = [(v(4)-sqrt(v(6)))/v(10); (v(4)+sqrt(v(6)))/v(10); v(1)];
   q = 5;
   B = [c, A; q, b];

elseif (strcmp(method_name,'RadauIIA-3-5-IRK'))

   A = [(v(88)-v(7)*sqrt(v(6)))/v(360), (v(296)-v(169)*sqrt(v(6)))/v(1800), (-v(2)+v(3)*sqrt(v(6)))/v(225); ...
      (v(296)+v(169)*sqrt(v(6)))/v(1800), (v(88)+v(7)*sqrt(v(6)))/v(360), (-v(2)-v(3)*sqrt(v(6)))/v(225); ...
      (v(16)-sqrt(v(6)))/v(36), (v(16)+sqrt(v(6)))/v(36), v(1)/v(9)];
   b = [(v(16)-sqrt(v(6)))/v(36), (v(16)+sqrt(v(6)))/v(36), v(1)/v(9)];
   c = [(v(4)-sqrt(v(6)))/v(10); (v(4)+sqrt(v(6)))/v(10); v(1)];
   q = 5;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIII-3-4-IRK'))

   A = [z, z, z; v(1)/v(4), v(1)/v(4), z; z, v(1), z];
   b = [v(1)/v(6), v(2)/v(3), v(1)/v(6)];
   c = [z; v(0.5); v(1)];
   q = 4;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIA-3-4-IRK'))

   A = [ z, z, z; v(5)/v(24), v(1)/v(3), v(-1)/v(24); v(1)/v(6), v(2)/v(3), v(1)/v(6)];
   b = [ v(1)/v(6), v(2)/v(3), v(1)/v(6)];
   c = [ z; v(1)/v(2); v(1)];
   q = 4;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIB-3-4-IRK'))

   A = [ v(1)/v(6), v(-1)/v(6), z; v(1)/v(6), v(1)/v(3), z; v(1)/v(6), v(5)/v(6), z];
   b = [ v(1)/v(6), v(2)/v(3), v(1)/v(6)];
   c = [ z; v(1)/v(2); v(1)];
   q = 4;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIC-3-4-IRK'))

   A = [ v(1)/v(6), v(-1)/v(3), v(1)/v(6); v(1)/v(6), v(5)/v(12), v(-1)/v(12); v(1)/v(6), v(2)/v(3), v(1)/v(6)];
   b = [ v(1)/v(6), v(2)/v(3), v(1)/v(6)];
   c = [ z; v(1)/v(2); v(1)];
   q = 4;
   B = [c, A; q, b];

elseif (strcmp(method_name,'RadauIIA-4-7-IRK'))

   A = [v(0.1129994793231561859938500530113885006791), v(-0.04030922072352220573554988839315989493430), ...
          v(0.02580237742033639103594009159581420862867), v(-0.009904676507266423898694112444586617487772);
        v(0.2343839957474002565736616739674733665127), v(0.2068925739353589001046450988221595237882), ...
          v(-0.04785712804854071885000849114278849491118), v(0.01604742280651627303662797042198549866226);
        v(0.2166817846232503418440524970718442978930), v(0.4061232638673733112251985775422159337208), ...
          v(0.1890365181700563424729334195950234041041), v(-0.02418210489983293951694260433308401236982);
        v(0.2204622111767683752754784720371859890529), v(0.3881934688431718807802323068900171791981), ...
          v(0.3288443199800597439442892210727968317490), v(0.0625)];
   b = [v(0.2204622111767683752754784720371859890529), v(0.3881934688431718807802323068900171791981), ...
        v(0.3288443199800597439442892210727968317490), v(0.06250000000000000000000000000000000000000)];
   c = [v(0.08858795951270394739554614376945619688573); v(0.4094668644407347108649262520688298940519); ...
        v(0.7876594617608470560252418898759996233481); v(1)];
   q = 7;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIII-4-6-IRK'))

   A = [z, z, z, z; ...
      (v(5)+sqrt(v(5)))/v(60), v(1)/v(6), (v(15)-v(7)*sqrt(v(5)))/v(60), z; ...
      (v(5)-sqrt(v(5)))/v(60), (v(15)+v(7)*sqrt(v(5)))/v(60), v(1)/v(6), z; ...
      v(1)/v(6), (v(5)-sqrt(v(5)))/v(12), (v(5)+sqrt(v(5)))/v(12), z];
   b = [v(1)/v(12), v(5)/v(12), v(5)/v(12), v(1)/v(12)];
   c = [z; (v(5)-sqrt(v(5)))/v(10); (v(5)+sqrt(v(5)))/v(10); v(1)];
   q = 6;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIA-4-6-IRK'))

   A = [z, z, z, z; ...
      (v(11)+sqrt(v(5)))/v(120), (v(25)-sqrt(v(5)))/v(120), (v(25)-v(13)*sqrt(v(5)))/v(120), (-v(1)+sqrt(v(5)))/v(120); ...
      (v(11)-sqrt(v(5)))/v(120), (v(25)+v(13)*sqrt(v(5)))/v(120), (v(25)+sqrt(v(5)))/v(120), (-v(1)-sqrt(v(5)))/v(120); ...
      v(1)/v(12), v(5)/v(12), v(5)/v(12), v(1)/v(12)];
   b = [v(1)/v(12), v(5)/v(12), v(5)/v(12), v(1)/v(12)];
   c = [z; (v(5)-sqrt(v(5)))/v(10); (v(5)+sqrt(v(5)))/v(10); v(1)];
   q = 6;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIB-4-6-IRK'))

   A = [v(1)/v(12), (-v(1)-sqrt(v(5)))/v(24), (-v(1)+sqrt(v(5)))/v(24), z; ...
      v(1)/v(12), (v(25)+sqrt(v(5)))/v(120), (v(25)-v(13)*sqrt(v(5)))/v(120), z; ...
      v(1)/v(12), (v(25)+v(13)*sqrt(v(5)))/v(120), (v(25)-sqrt(v(5)))/v(120), z; ...
      v(1)/v(12), (v(11)-sqrt(v(5)))/v(24), (v(11)+sqrt(v(5)))/v(24), z];
   b = [v(1)/v(12), v(5)/v(12), v(5)/v(12), v(1)/v(12)];
   c = [z; (v(5)-sqrt(v(5)))/v(10); (v(5)+sqrt(v(5)))/v(10); v(1)];
   q = 6;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIC-4-6-IRK'))

   A = [v(1)/v(12), -sqrt(v(5))/v(12), sqrt(v(5))/v(12), -v(1)/v(12); ...
      v(1)/v(12), v(1)/v(4), (v(10)-v(7)*sqrt(v(5)))/v(60), sqrt(v(5))/v(60); ...
      v(1)/v(12), (v(10)+v(7)*sqrt(v(5)))/v(60), v(1)/v(4), -sqrt(v(5))/v(60); ...
      v(1)/v(12), v(5)/v(12), v(5)/v(12), v(1)/v(12)];
   b = [v(1)/v(12), v(5)/v(12), v(5)/v(12), v(1)/v(12)];
   c = [z; (v(5)-sqrt(v(5)))/v(10); (v(5)+sqrt(v(5)))/v(10); v(1)];
   q = 6;
   B = [c, A; q, b];

elseif (strcmp(method_name,'RadauIIA-5-9-IRK'))

   A = [v(0.07299886431790337), v(-0.02673533110794565), v(0.01867692976398445), ...
          v(-0.01287910609330652), v(0.005042839233882052);
      v(0.1537752314791824), v(0.1462148678474935), v(-0.03644456890512816), ...
          v(0.02123306311930480), v(-0.007935579902728813);
      v(0.1400630456848099), v(0.2989671294912833), v(0.1675850701352492), ...
          v(-0.03396910168661794), v(0.01094428874419233);
      v(0.1448943081095342), v(0.2765000687601608), v(0.3257979229104191), ...
          v(0.1287567532549115), v(-0.01570891737880607);
      v(0.1437135607912259), v(0.2813560151494621), v(0.3118265229757413), ...
          v(0.2231039010835707), v(0.04)];
   b = [v(0.1437135607912259), v(0.2813560151494621), v(0.3118265229757413), ...
      v(0.2231039010835707), v(0.04)];
   c = [v(0.05710419611451768); v(0.2768430136381238); v(0.5835904323689168); ...
      v(0.8602401356562195); v(1)];
   q = 9;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIII-5-8-IRK'))

   A = [z, z, z, z, z; ...
      v(1)/v(14), v(1)/v(9), (v(13)-v(3)*sqrt(v(21)))/v(63), (v(14)-v(3)*sqrt(v(21)))/v(126), z; ...
      v(1)/v(32), (v(91)+v(21)*sqrt(v(21)))/v(576), v(11)/v(72), (v(91)-v(21)*sqrt(v(21)))/v(576), z; ...
      v(1)/v(14), (v(14)+v(3)*sqrt(v(21)))/v(126), (v(13)+v(3)*sqrt(v(21)))/v(63), v(1)/v(9), z; ...
      z, v(7)/v(18), v(2)/v(9), v(7)/v(18), z];
   b = [v(1)/v(20), v(49)/v(180), v(16)/v(45), v(49)/v(180), v(1)/v(20)];
   c = [z; (v(7)-sqrt(v(21)))/v(14); v(1)/v(2); (v(7)+sqrt(v(21)))/v(14); v(1)];
   q = 8;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIA-5-8-IRK'))

   A = [z, z, z, z, z; ...
      (v(119)+v(3)*sqrt(v(21)))/v(1960), (v(343)-v(9)*sqrt(v(21)))/v(2520), (v(392)-v(96)*sqrt(v(21)))/v(2205), (v(343)-v(69)*sqrt(v(21)))/v(2520), (-v(21)+v(3)*sqrt(v(21)))/v(1960); ...
      v(13)/v(320), (v(392)+v(105)*sqrt(v(21)))/v(2880), v(8)/v(45), (v(392)-v(105)*sqrt(v(21)))/v(2880), v(3)/v(320); ...
      (v(119)-v(3)*sqrt(v(21)))/v(1960), (v(343)+v(69)*sqrt(v(21)))/v(2520), (v(392)+v(96)*sqrt(v(21)))/v(2205), (v(343)+v(9)*sqrt(v(21)))/v(2520), (-v(21)-v(3)*sqrt(v(21)))/v(1960); ...
      v(1)/v(20), v(49)/v(180), v(16)/v(45), v(49)/v(180), v(1)/v(20)];
   b = [v(1)/v(20), v(49)/v(180), v(16)/v(45), v(49)/v(180), v(1)/v(20)];
   c = [z; (v(7)-sqrt(v(21)))/v(14); v(1)/v(2); (v(7)+sqrt(v(21)))/v(14); v(1)];
   q = 8;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIB-5-8-IRK'))

   A = [v(1)/v(20), (-v(7)-sqrt(v(21)))/v(120), v(1)/v(15), (-v(7)+sqrt(v(21)))/v(120), z; ...
      v(1)/v(20), (v(343)+v(9)*sqrt(v(21)))/v(2520), (v(56)-v(15)*sqrt(v(21)))/v(315), (v(343)-v(69)*sqrt(v(21)))/v(2520), z; ...
      v(1)/v(20), (v(49)+v(12)*sqrt(v(21)))/v(360), v(8)/v(45), (v(49)-v(12)*sqrt(v(21)))/v(360), z; ...
      v(1)/v(20), (v(343)+v(69)*sqrt(v(21)))/v(2520), (v(56)+v(15)*sqrt(v(21)))/v(315), (v(343)-v(9)*sqrt(v(21)))/v(2520), z; ...
      v(1)/v(20), (v(119)-v(3)*sqrt(v(21)))/v(360), v(13)/v(45), (v(119)+v(3)*sqrt(v(21)))/v(360), z];
   b = [v(1)/v(20), v(49)/v(180), v(16)/v(45), v(49)/v(180), v(1)/v(20)];
   c = [z; (v(7)-sqrt(v(21)))/v(14); v(1)/v(2); (v(7)+sqrt(v(21)))/v(14); v(1)];
   q = 8;
   B = [c, A; q, b];

elseif (strcmp(method_name,'LobattoIIIC-5-8-IRK'))

   A = [v(1)/v(20), v(-7)/v(60), v(2)/v(15), v(-7)/v(60), v(1)/v(20); ...
      v(1)/v(20), v(29)/v(180), (v(47)-v(15)*sqrt(v(21)))/v(315), (v(203)-v(30)*sqrt(v(21)))/v(1260), -v(3)/v(140); ...
      v(1)/v(20), (v(329)+v(105)*sqrt(v(21)))/v(2880), v(73)/v(360), (v(329)-v(105)*sqrt(v(21)))/v(2880), v(3)/v(160); ...
      v(1)/v(20), (v(203)+v(30)*sqrt(v(21)))/v(1260), (v(47)+v(15)*sqrt(v(21)))/v(315), v(29)/v(180), v(-3)/v(140); ...
      v(1)/v(20), v(49)/v(180), v(16)/v(45), v(49)/v(180), v(1)/v(20)];
   b = [v(1)/v(20), v(49)/v(180), v(16)/v(45), v(49)/v(180), v(1)/v(20)];
   c = [z; (v(7)-sqrt(v(21)))/v(14); v(1)/v(2); (v(7)+sqrt(v(21)))/v(14); v(1)];
   q = 8;
   B = [c, A; q, b];

elseif (strcmp(method_name,'ESDIRK3(2)4L[2]SA'))

   % From: equations 27-28 of Kennedy & Carpenter, Appl. Numer. Math. 2019

   g = v(0.43586652150845899941601945);
   g2 = g*g;
   g3 = g2*g;
   g4 = g3*g;
   g5 = g4*g;
   c3 = v(3)/v(5);
   a32 = c3*(c3-v(2)*g)/(v(4)*g);
   a31 = c3 - g - a32;
   b2 = (-v(2)+v(3)*c3+v(6)*g*(v(1)-c3))/(v(12)*g*(c3-v(2)*g));
   b3 = (v(1)-v(6)*g+v(6)*g2)/(v(3)*c3*(c3-v(2)*g));
   b1 = v(1) - g - b2 - b3;
   d2 = c3*(-v(1)+v(6)*g-v(24)*g3+v(12)*g4-v(6)*g5)/(v(4)*g*(v(2)*g-c3)*(v(1)-v(6)*g+v(6)*g2)) ...
        + (v(3)-v(27)*g+v(68)*g2-v(55)*g3+v(21)*g4-v(6)*g5)/(v(2)*(v(2)*g-c3)*(v(1)-v(6)*g+v(6)*g2));
   d3 = -g*(-v(2)+v(21)*g-v(68)*g2+v(79)*g3-v(33)*g4+v(12)*g5)/(c3*(c3-v(2)*g)*(v(1)-v(6)*g+v(6)*g2));
   d4 = -v(3)*g2*(-v(1)+v(4)*g-v(2)*g2+g3)/(v(1)-v(6)*g+v(6)*g2);
   d1 = v(1) - d2 - d3 - d4;
   A = [z, z, z, z; ...
        g, g, z, z; ...
        a31, a32, g, z; ...
        b1, b2, b3, g];
   c = [0; v(2)*g; v(3)/v(5); v(1)];
   b = [b1, b2, b3, g];
   d = [d1, d2, d3, d4];
   q = 3;
   p = 2;
   B = [c, A; q, b; p, d];

elseif (strcmp(method_name,'ESDIRK3(2)5L[2]SA'))

  % From: Table 10 of Kennedy & Carpenter, NASA/TM-2016-219173

   A = [z, z, z, z, z; ...
        v(9)/v(40), v(9)/v(40), z, z, z; ...
        v(9)*(v(1)+sqrt(v(2)))/v(80), v(9)*(v(1)+sqrt(v(2)))/v(80), v(9)/v(40), z, z; ...
        (v(22)+v(15)*sqrt(v(2)))/v(80)/(v(1)+sqrt(v(2))), (v(22)+v(15)*sqrt(v(2)))/v(80)/(v(1)+sqrt(v(2))), -v(7)/v(40)/(v(1)+sqrt(v(2))), v(9)/v(40), z;...
        (v(2398)+v(1205)*sqrt(v(2)))/v(2835)/(v(4)+v(3)*sqrt(v(2))), (v(2398)+v(1205)*sqrt(v(2)))/v(2835)/(v(4)+v(3)*sqrt(v(2))), -v(2374)*(v(1)+v(2)*sqrt(v(2)))/v(2835)/(v(5)+v(3)*sqrt(v(2))), v(5827)/v(7560), v(9)/v(40)];
   b = [(v(2398)+v(1205)*sqrt(v(2)))/v(2835)/(v(4)+v(3)*sqrt(v(2))), (v(2398)+v(1205)*sqrt(v(2)))/v(2835)/(v(4)+v(3)*sqrt(v(2))), -v(2374)*(v(1)+v(2)*sqrt(v(2)))/v(2835)/(v(5)+v(3)*sqrt(v(2))), v(5827)/v(7560), v(9)/v(40)];
   c = [z; v(9)/v(20); v(9)*(v(2)+sqrt(v(2)))/v(40); v(3)/v(5); v(1)];
   b2 = [v(4555948517383)/v(24713416420891), v(4555948517383)/v(24713416420891), -v(7107561914881)/v(25547637784726), v(30698249)/v(44052120), v(49563)/v(233080)];
   q = 3;
   p = 2;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'ESDIRK3(2I)5L[2]SA'))

  % From: Table 11 of Kennedy & Carpenter, NASA/TM-2016-219173

   c = [z; v(9)/v(20); v(4)/v(5); v(1); v(1)];
   b = [v(7415)/v(34776), v(9920)/v(30429), v(4845)/v(9016), -v(5827)/v(19320), v(9)/v(40)];
   b2 = [v(23705)/v(104328), v(29720)/v(91287), v(4225)/v(9016), -v(69304987)/v(337732920), v(42843)/v(233080)];
   A = [z, z, z, z, z; ...
        v(9)/v(40), v(9)/v(40), z, z, z; ...
        v(19)/v(72), v(14)/v(45), v(9)/v(40), z, z; ...
        v(3337)/v(11520), v(233)/v(720), v(207)/v(1280), v(9)/v(40), z; ...
        v(7415)/v(34776), v(9920)/v(30429), v(4845)/v(9016), -v(5827)/v(19320), v(9)/v(40)];
   q = 3;
   p = 2;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'SDIRK-5-4'))

   A = [v(1)/v(4), z, z, z, z; ...
      v(1)/v(2), v(1)/v(4), z, z, z; ...
      v(17)/v(50), v(-1)/v(25), v(1)/v(4), z, z; ...
      v(371)/v(1360), v(-137)/v(2720), v(15)/v(544), v(1)/v(4), z; ...
      v(25)/v(24), v(-49)/v(48), v(125)/v(16), v(-85)/v(12), v(1)/v(4)];
   b = [v(25)/v(24), v(-49)/v(48), v(125)/v(16), v(-85)/v(12), v(1)/v(4)];
   c = [v(1)/v(4); v(3)/v(4); v(11)/v(20); v(1)/v(2); v(1)];
   b2 = [v(59)/v(48), v(-17)/v(96), v(225)/v(32), v(-85)/v(12), z];
   q = 4;
   p = 3;
   B = [c, A; q, b; p, b2];

elseif (strcmp(method_name,'Gauss-6-12-IRK'))

   A = [v(0.042831123094792580851996218950605), v(-0.014763725997197424643891429014278),  ...
          v(0.0093250507064777618411400734121424), v(-0.0056688580494835162182488917046817), ...
          v(0.0028544333150993149102007359161104), v(-0.00081278017126476782600392067714199); ...
      v(0.092673491430378856970823740288243),  v(0.090190393262034655662118827897123),  ...
          v(-0.020300102293239581308124404430781),  v(0.010363156240246421640614877198502),  ...
          v(-0.0048871929280376802268550750181669), v(0.001355561055485051944941864725486);  ...
      v(0.082247922612843859526233540856659),  v(0.19603216233324501065540377853111),   ...
          v(0.11697848364317276194496135254516),  v(-0.020482527745656096032756375665715),  ...
          v(0.007989991899662334513029865501749), v(-0.0020756257848663355105554732114538); ...
      v(0.087737871974451497214547911112663),  v(0.1723907946244069768112077902925),    ...
          v(0.25443949503200161992267908075603),   v(0.11697848364317276194496135254516),   ...
          v(-0.015651375809175699331166122736864),  v(0.00341432357674130217775889704455);   ...
      v(0.084306685134100109759050573175723),  v(0.18526797945210699155109273081241),   ...
          v(0.22359381104609910224930782789182),   v(0.2542570695795851051980471095211),    ...
          v(0.090190393262034655662118827897123), v(-0.007011245240793695266831302387034);  ...
      v(0.086475026360849929529996358578351),  v(0.17752635320896999641403691987814),   ...
          v(0.239625825335829040108171596795),     v(0.22463191657986776204878263167818),   ...
          v(0.19514451252126673596812908480852),   v(0.042831123094792580851996218950605)];
   b = [v(0.085662246189585161703992437901209), v(0.18038078652406931132423765579425), ...
      v(0.23395696728634552388992270509032), v(0.23395696728634552388992270509032), ...
      v(0.18038078652406931132423765579425), v(0.085662246189585161703992437901209)];
   c = [v(0.0337652428984239749709672651079); v(0.16939530676686775922945571437594);
      v(0.38069040695840154764351126459587); v(0.61930959304159845235648873540413);
      v(0.83060469323313224077054428562406); v(0.9662347571015760250290327348921)];
   q = 12;
   B = [c, A; q, b];

elseif (strcmp(method_name,'ARK(2,3,2)-ERK'))

   gamma = v(1) - v(1)/sqrt(v(2));
   alpha = v(1)/v(6) * (v(3)+v(2)*sqrt(v(2)));
   delta = v(1)/(v(2)*sqrt(v(2)));
   twogamma = v(2) * gamma;

   A = [z,         z,     z; ...
        twogamma,  z,     z; ...
        v(1) - alpha, alpha, z];
   b = [delta, delta, gamma];
   c = [z; twogamma; v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'ARK(2,3,2)-SDIRK'))

   gamma = v(1) - v(1)/sqrt(v(2));
   alpha = v(1)/v(6) * (v(3)+v(2)*sqrt(v(2)));
   delta = v(1)/(v(2)*sqrt(v(2)));
   twogamma = v(2) * gamma;

   A = [z,     z,     z; ...
        gamma, gamma, z; ...
        delta, delta, gamma];
   b = [delta, delta, gamma];
   c = [z; twogamma; v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(2,2,2)-ERK'))

   A = [z, z; ...
        v(1), z];
   b = [v(1)/v(2), v(1)/v(2)];
   c = [z; v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(2,2,2)-SDIRK'))

   gamma = v(1) - v(1)/sqrt(v(2));

   A = [gamma,       z;...
        v(1) - v(2)*gamma, gamma];
   b = [v(1)/v(2), v(1)/v(2)];
   c = [gamma; v(1) - gamma];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-lpm1-ERK'))

   A = [  z,   z, z;...
        v(1)/v(2),   z, z;...
        v(1)/v(2), v(1)/v(2), z];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [z; v(1)/v(2); v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-lpm1-SDIRK'))

   A = [         v(2)/v(11),    z,    z;...
            v(2829)/v(9317), v(2)/v(11),    z;...
        v(148529)/v(428582), v(7)/v(23), v(2)/v(11)];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [v(2)/v(11); v(4523)/v(9317); v(15517)/v(18634)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-lpm2-ERK'))

   A = [  z,   z, z;...
        v(1)/v(2),   z, z;...
        v(1)/v(2), v(1)/v(2), z];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [z; v(1)/v(2); v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-lpm2-SDIRK'))

   A = [        v(2)/v(11),     z,    z;...
          v(2583)/v(13310),  v(2)/v(11),    z;...
        v(39731)/v(139755), v(10)/v(21), v(2)/v(11)];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [v(2)/v(11); v(5003)/v(13310); v(6271)/v(6655)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-lpum-ERK'))

   A = [  z,   z, z;...
        v(1)/v(2),   z, z;...
        v(1)/v(2), v(1)/v(2), z];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [z; v(1)/v(2); v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-lpum-SDIRK'))

   A = [        v(2)/v(11),      z,    z;...
              v(41)/v(154),   v(2)/v(11),    z;...
             v(289)/v(847), v(42)/v(121), v(2)/v(11)];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [v(2)/v(11); v(69)/v(154); v(67)/v(77)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-lspum-ERK'))

   A = [    z,     z, z;...
          v(5)/v(6),     z, z;...
        v(11)/v(24), v(11)/v(24), z];
   b = [v(24)/v(55), v(1)/v(5), v(4)/v(11)];
   c = [z; v(5)/v(6); v(11)/v(12)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-lspum-SDIRK'))

   A = [        v(2)/v(11),      z,    z;...
             v(205)/v(462),   v(2)/v(11),    z;...
           v(2033)/v(4620), v(21)/v(110), v(2)/v(11)];
   b = [v(24)/v(55), v(1)/v(5), v(4)/v(11)];
   c = [v(2)/v(11); v(289)/v(462); v(751)/v(924)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-a-ERK'))

   A = [  z,   z, z;...
        v(1)/v(2),   z, z;...
        v(1)/v(2), v(1)/v(2), z];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [z; v(1)/v(2); 1.0];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-a-DIRK'))

   A = [v(1)/v(4),   z,   z;...
          z, v(1)/v(4),   z;...
        v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [v(1)/v(4); v(1)/v(4); v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-b-ERK'))

   A = [  z,   z, z;...
        v(1)/v(2),   z, z;...
        v(1)/v(2), v(1)/v(2), z];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [z; v(1)/v(2); v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP2(3,3,2)-b-DIRK'))

   A = [ v(1)/v(5),   z,   z;...
        v(1)/v(10), v(1)/v(5),   z;...
         v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   b = [v(1)/v(3), v(1)/v(3), v(1)/v(3)];
   c = [v(1)/v(5); v(3)/v(10); v(1)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP3(3,3,2)-ERK'))

   A = [  z,   z, z;...
          v(1),   z, z;...
        v(1)/v(4), v(1)/v(4), z];
   b = [v(1)/v(6), v(1)/v(6), v(2)/v(3)];
   c = [z; v(1); v(1)/v(2)];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP3(3,3,2)-SDIRK'))

   gamma = v(1) - v(1)/sqrt(v(2));
   A = [      gamma,     z,     z;...
        v(1) - v(2)*gamma, gamma,     z;...
        v(1)/v(2) - gamma,     z, gamma];
   b = [v(1)/v(6), v(1)/v(6), v(2)/v(3)];
   c = [gamma; v(1)-gamma; v(1)/v(2)];
   q = 2;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP3(3,3,3)-ERK'))

   A = [  z,   z, z;...
          1,   z, z;...
        v(1)/v(4), v(1)/v(4), z];
   b = [v(1)/v(6), v(1)/v(6), v(2)/v(3)];
   c = [z; v(1); v(1)/v(2)];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP3(3,3,3)-ESDIRK'))

   A = [    z,    z,    z;...
        v(14)/v(15), v(1)/v(15),    z;...
         v(7)/v(30),  v(1)/v(5), v(1)/v(15)];
   b = [v(1)/v(6), v(1)/v(6), v(2)/v(3)];
   c = [z; v(1); v(1)/v(2)];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP3(4,3,3)-ERK'))

   A = [  z,   z,   z, z;...
          z,   z,   z, z;...
          z,   v(1),   z, z;...
          z, v(1)/v(4), v(1)/v(4), z];
   b = [z, v(1)/v(6), v(1)/v(6), v(2)/v(3)];
   c = [z;   z;   v(1); v(1)/v(2)];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSP3(4,3,3)-SDIRK'))

   alpha = v(0.24169426078821);
   beta  = v(0.06042356519705);
   eta   = v(0.12915286960590);
   delta = v(0.5) - beta - eta - alpha;

   A = [ alpha,       z,     0      z;...
        -alpha,   alpha,     z,     z;...
             z, v(1)-alpha, alpha,     z;
          beta,     eta, delta, alpha];
   b = [z,     v(1)/v(6), v(1)/v(6), v(2)/v(3)];
   c = [alpha;   z;   v(1); v(1)/v(2)];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'SSPRK(3,3)-Shu-Osher-ERK'))

   A = [ z,   z,   z;...
         v(1),   z,   z;...
         v(1)/v(4), v(1)/v(4), z];
   b = [ v(1)/v(6), v(1)/v(6), v(2)/v(3)];
   c = [ z;   v(1);   v(1)/v(2)];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'EDIRK-3-3'))

   % Pairs with SSPRK(3,3)-Shu-Osher-ERK to make 3rd order IMEX method
   %
   % General form (with free parameter beta):
   %
   % gamma = (2*beta^2 - (3/2)*beta + 1/3)/(2-4*beta);
   % A = [ z,              z,                z;...
   %       4*gamma+2*beta, 1-4*gamma-2*beta, z;...
   %       1/2-beta-gamma, gamma,            beta];
   %
   % From: Section 3.2.3 of Conde et al., doi: 10.1007/s10915-017-0560-2

   beta  = v(2)/v(3);
   gamma = -v(1)/v(3);

   A = [ z,   z,    z;...
         z,   v(1),   z;...
         v(1)/v(6), v(-1)/v(3), v(2)/v(3)];
   b = [ v(1)/v(6), v(1)/v(6), v(2)/v(3)];
   c = [ z;   v(1);   v(1)/v(2)];
   q = 3;
   B = [c, A; q, b];

elseif (strcmp(method_name,'ESDIRK-3-3'))

   % Pairs with SSPRK(3,3)-Shu-Osher-ERK to make 3rd order IMEX method
   %
   % In general gamma = (2*beta^2 - (3/2)*beta + 1/3)/(2-4*beta);
   %
   % From: Section 3.2.3 of Conde et al., doi: 10.1007/s10915-017-0560-2

   beta  = sqrt(v(3))/v(6) + v(1)/v(2);
   gamma = (-v(1)/v(8))*(sqrt(v(3))+v(1));

   A = [ z,              z,                z;...
         v(4)*gamma+v(2)*beta, v(1)-v(4)*gamma-v(2)*beta, z;...
         v(1)/v(2)-beta-gamma, gamma,            beta];
   b = [ v(1)/v(6), v(1)/v(6), v(2)/v(3)];
   c = [ z;   v(1);   v(1)/v(2)];
   q = 3;
   B = [c, A; q, b];

else

   B = 0;
   fprintf('Butcher error, method %s not defined\n',method_name);

end

% end of function
